

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tutorials (Jupyter Notebooks) &mdash; pyaerocom  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pyaerocom  documentation" href="index.html"/>
        <link rel="next" title="API" href="api.html"/>
        <link rel="prev" title="Introduction" href="readme.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pyaerocom
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#documentation">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="readme.html#getting-started">Getting started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorials (Jupyter Notebooks)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pyaerocom-api-flowchart-minimal">Pyaerocom API flowchart (minimal)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#check-data-directory">Check data directory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reading-of-and-working-with-gridded-model-data-readgridded-and-griddeddata-classes">Reading of and working with <em>gridded</em> model data (<code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> and <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> classes)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#find-model-data">Find model data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#read-aerosol-optical-depth-at-550-nm">Read Aerosol optical depth at 550 nm</a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview-of-what-is-in-the-data">Overview of what is in the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#access-time-stamps">Access time stamps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plotting-maps">Plotting maps</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering">Filtering</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filtering-of-time">Filtering of time</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-aggregation">Data aggregation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#reading-of-and-working-with-ungridded-data-readungridded-and-ungriddeddata-classes">Reading of and working with ungridded data (<code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> and <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> classes)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#caching-of-ungriddeddata">Caching of UngriddedData</a></li>
<li class="toctree-l4"><a class="reference internal" href="#read-aeronet-sun-v3-level-2-data">Read Aeronet Sun v3 level 2 data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#access-of-individual-stations">Access of individual stations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#colocation-of-model-and-obsdata">Colocation of model and obsdata</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aerocom-default-regions">AEROCOM default regions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#load-example-data-and-apply-region-specific-crop">Load example data and apply region specific crop</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-model-data-the-readgridded-class">Reading model data: the <em>ReadGridded</em> class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#remark-on-time-definition">Remark on time definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#a-very-brief-introduction-into-the-griddeddata-class">A very brief introduction into the GriddedData class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reading-data-from-multiple-models-the-readgriddedmulti-class">Reading data from multiple models: the ReadGriddedMulti class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#iterate-over-models-and-variables">Iterate over models and variables</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#introducing-the-griddeddata-class">Introducing the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#remark-on-longitude-definition">Remark on longitude definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="#features-of-the-griddeddata-class">Features of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#more-to-come">… more to come</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#colocating-gridded-data-with-discrete-observations">Colocating gridded data with discrete observations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#note">NOTE</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-setup-and-imports">Import setup and imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-of-model-data">Import of model data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-of-aeronet-sun-v3-data-level-2">Import of AeroNet Sun V3 data (Level 2)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#now-perform-collocation-and-plot-corresponding-scatter-plots-with-statistical-values">Now perform collocation and plot corresponding scatter plots with statistical values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#monthly-world-no-mountains">2010 monthly World no mountains</a></li>
<li class="toctree-l4"><a class="reference internal" href="#daily-europe-no-mountains">2010 daily Europe no mountains</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#handling-of-time-in-pyaerocom">Handling of time in pyaerocom</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#load-and-some-example-data">Load and some example data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#digging-into-the-time-representation-of-the-iris-cube-datatype">Digging into the time representation of the iris Cube datatype</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#peculiarities-of-time-handling-when-using-the-cube-interface">Peculiarities of time handling when using the <code class="docutils literal notranslate"><span class="pre">Cube</span></code> interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-options-to-convert-timestamps">Other options to convert timestamps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#how-pya-does-it">How pya does it</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tutorial-showing-how-to-read-ebas-nasa-ames-files">Tutorial showing how to read EBAS NASA Ames files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#column-information">Column information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#access-flag-information">Access flag information</a></li>
<li class="toctree-l3"><a class="reference internal" href="#convert-object-to-pandas-dataframe">Convert object to pandas Dataframe</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ebas-file-query-and-database-browser">EBAS file query and database browser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#specifying-a-request">Specifying a request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execution-of-file-request-query">Execution of file request query</a></li>
<li class="toctree-l3"><a class="reference internal" href="#browsing-the-database">Browsing the database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-browsing">Custom browsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#read-all-files">Read all files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api_testsuite.html">Tests (for developers)</a></li>
<li class="toctree-l1"><a class="reference internal" href="config_files.html">Configuration files</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyaerocom</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Tutorials (Jupyter Notebooks)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/tutorials.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="tutorials-jupyter-notebooks">
<h1>Tutorials (Jupyter Notebooks)<a class="headerlink" href="#tutorials-jupyter-notebooks" title="Permalink to this headline">¶</a></h1>
<p>In this section you can find example tutorial notebooks for Pyaerocom.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Under development</p>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>This notebook is meant to give a quick introduction into pyaerocom based
and into some of the relevant features and workflows when using
<a class="reference external" href="http://aerocom.met.no/pyaerocom/">pyaerocom</a>.</p>
<p>It ends with a colocation of CAM53-Oslo model AODs both all-sky and
clear-sky with Aeronet Sun V3 level 2 data.</p>
<div class="section" id="pyaerocom-api-flowchart-minimal">
<h3>Pyaerocom API flowchart (minimal)<a class="headerlink" href="#pyaerocom-api-flowchart-minimal" title="Permalink to this headline">¶</a></h3>
<p>The following flowchart illustrates the minimal workflow to create
standard output in pyaerocom based on a user query (that typically
comprises a model ID and observation ID as well as one (or more)
variable(s) of interest (products indicated in red are not available
yet, date of latest update: 4-10-2018).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">flowchart</span> <span class="o">=</span> <span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;../suppl/api_minimal_v0.png&#39;</span><span class="p">))</span>
<span class="n">flowchart</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_2_0.png" src="_images/tut00_get_started_2_0.png" />
<p>A user query typically comprises a model (+ experiment -&gt; model run) and
an observation network, which are supposed to be compared.</p>
<p><strong>Note</strong>: the flowchart depicts a situation, where the data from the
observation network is <em>ungridded</em>, that is, the data is not available
in a gridded format such as NetCDF, but, for instance, in the form of
column seperated text files (as is the case for Aeronet data, which is
used as an example here and included in the test dataset). For
<code class="docutils literal notranslate"><span class="pre">gridded</span></code> observations (e.g.&nbsp;satellite data), the flowchart is
equivalent but with <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class and <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> for the
observation branch (and without caching).</p>
<p>This notebook illustrates and briefly discusses the individual aspects
displayed in the flowchart.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
</pre></div>
</div>
<div class="section" id="check-data-directory">
<h4>Check data directory<a class="headerlink" href="#check-data-directory" title="Permalink to this headline">¶</a></h4>
<p>By default, pyaerocom assumes that the AEROCOM database can be accessed
(cf.&nbsp;top of flowchart), that is, it initiates all data query paths
relative to the database server path names.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">BASEDIR</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;/lustre/storeA/project/aerocom/&#39;</span>
</pre></div>
</div>
<p><strong>NOTE</strong>: Execution of the following lines will only work if you are
connected to the AEROCOM data server or if you have access to the
pyaerocom testdataset. The latter can be retrieved upon request (please
contact <a class="reference external" href="mailto:jonasg&#37;&#52;&#48;met&#46;no">jonasg<span>&#64;</span>met<span>&#46;</span>no</a>).</p>
</div>
</div>
<div class="section" id="reading-of-and-working-with-gridded-model-data-readgridded-and-griddeddata-classes">
<h3>Reading of and working with <em>gridded</em> model data (<code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> and <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> classes)<a class="headerlink" href="#reading-of-and-working-with-gridded-model-data-readgridded-and-griddeddata-classes" title="Permalink to this headline">¶</a></h3>
<p>This section illustrates the reading of gridded data as well as some
features of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class of <em>pyaerocom</em>. First, however, we
have to find a valid model ID for the reading (cf.&nbsp;flow chart).</p>
<div class="section" id="find-model-data">
<h4>Find model data<a class="headerlink" href="#find-model-data" title="Permalink to this headline">¶</a></h4>
<p>The database contains data from the CAM53-Oslo model, which is used in
the following. You can use the <code class="docutils literal notranslate"><span class="pre">browse_database</span></code> function of pyaerocom
to find model ID’s (which can be quite cryptic sometimes) using wildcard
pattern search.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;CAM53*-Oslo*UNTUNED*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM53</span><span class="o">-</span><span class="n">Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PI_UNTUNED</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">NorESM_SVN_TEST</span><span class="o">/</span><span class="n">CAM53</span><span class="o">-</span><span class="n">Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PI_UNTUNED</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs440aercs&#39;</span><span class="p">,</span> <span class="s1">&#39;abs500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;abs670aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;airmass&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;asy3Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;bc5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;cheaqpso4&#39;</span><span class="p">,</span> <span class="s1">&#39;chegpso4&#39;</span><span class="p">,</span> <span class="s1">&#39;chepso2&#39;</span><span class="p">,</span> <span class="s1">&#39;cl3D&#39;</span><span class="p">,</span> <span class="s1">&#39;clt&#39;</span><span class="p">,</span> <span class="s1">&#39;drybc&#39;</span><span class="p">,</span> <span class="s1">&#39;drydms&#39;</span><span class="p">,</span> <span class="s1">&#39;drydust&#39;</span><span class="p">,</span> <span class="s1">&#39;dryoa&#39;</span><span class="p">,</span> <span class="s1">&#39;dryso2&#39;</span><span class="p">,</span> <span class="s1">&#39;dryso4&#39;</span><span class="p">,</span> <span class="s1">&#39;dryss&#39;</span><span class="p">,</span> <span class="s1">&#39;ec5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;ec550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;emibc&#39;</span><span class="p">,</span> <span class="s1">&#39;emidms&#39;</span><span class="p">,</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span> <span class="s1">&#39;emioa&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span> <span class="s1">&#39;emiss&#39;</span><span class="p">,</span> <span class="s1">&#39;hus&#39;</span><span class="p">,</span> <span class="s1">&#39;landf&#39;</span><span class="p">,</span> <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddms&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span> <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso2&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span> <span class="s1">&#39;loadss&#39;</span><span class="p">,</span> <span class="s1">&#39;mmraerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrbc&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrdu&#39;</span><span class="p">,</span> <span class="s1">&#39;mmroa&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrso4&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrss&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od670aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;orog&#39;</span><span class="p">,</span> <span class="s1">&#39;precip&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="s1">&#39;rlds&#39;</span><span class="p">,</span> <span class="s1">&#39;rlus&#39;</span><span class="p">,</span> <span class="s1">&#39;rlut&#39;</span><span class="p">,</span> <span class="s1">&#39;rlutcs&#39;</span><span class="p">,</span> <span class="s1">&#39;rsds&#39;</span><span class="p">,</span> <span class="s1">&#39;rsdscs&#39;</span><span class="p">,</span> <span class="s1">&#39;rsdt&#39;</span><span class="p">,</span> <span class="s1">&#39;rsus&#39;</span><span class="p">,</span> <span class="s1">&#39;rsut&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdms&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">,</span> <span class="s1">&#39;temp&#39;</span><span class="p">,</span> <span class="s1">&#39;vmrdms&#39;</span><span class="p">,</span> <span class="s1">&#39;vmrso2&#39;</span><span class="p">,</span> <span class="s1">&#39;wetbc&#39;</span><span class="p">,</span> <span class="s1">&#39;wetdms&#39;</span><span class="p">,</span> <span class="s1">&#39;wetdust&#39;</span><span class="p">,</span> <span class="s1">&#39;wetoa&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso2&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso4&#39;</span><span class="p">,</span> <span class="s1">&#39;wetss&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM53</span><span class="o">-</span><span class="n">Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom2</span><span class="o">/</span><span class="n">NorESM_SVN_TEST</span><span class="o">/</span><span class="n">CAM53</span><span class="o">-</span><span class="n">Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs440aercs&#39;</span><span class="p">,</span> <span class="s1">&#39;abs500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550aercs&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;abs670aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;airmass&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;asy3Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;bc5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;cheaqpso4&#39;</span><span class="p">,</span> <span class="s1">&#39;chegpso4&#39;</span><span class="p">,</span> <span class="s1">&#39;chepso2&#39;</span><span class="p">,</span> <span class="s1">&#39;cl3D&#39;</span><span class="p">,</span> <span class="s1">&#39;clt&#39;</span><span class="p">,</span> <span class="s1">&#39;drybc&#39;</span><span class="p">,</span> <span class="s1">&#39;drydms&#39;</span><span class="p">,</span> <span class="s1">&#39;drydust&#39;</span><span class="p">,</span> <span class="s1">&#39;dryoa&#39;</span><span class="p">,</span> <span class="s1">&#39;dryso2&#39;</span><span class="p">,</span> <span class="s1">&#39;dryso4&#39;</span><span class="p">,</span> <span class="s1">&#39;dryss&#39;</span><span class="p">,</span> <span class="s1">&#39;ec5503Daer&#39;</span><span class="p">,</span> <span class="s1">&#39;ec550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;emibc&#39;</span><span class="p">,</span> <span class="s1">&#39;emidms&#39;</span><span class="p">,</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span> <span class="s1">&#39;emioa&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span> <span class="s1">&#39;emiss&#39;</span><span class="p">,</span> <span class="s1">&#39;hus&#39;</span><span class="p">,</span> <span class="s1">&#39;landf&#39;</span><span class="p">,</span> <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddms&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span> <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso2&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span> <span class="s1">&#39;loadss&#39;</span><span class="p">,</span> <span class="s1">&#39;mmraerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrbc&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrdu&#39;</span><span class="p">,</span> <span class="s1">&#39;mmroa&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrso4&#39;</span><span class="p">,</span> <span class="s1">&#39;mmrss&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od670aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870csaer&#39;</span><span class="p">,</span> <span class="s1">&#39;orog&#39;</span><span class="p">,</span> <span class="s1">&#39;precip&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="s1">&#39;ps&#39;</span><span class="p">,</span> <span class="s1">&#39;rlds&#39;</span><span class="p">,</span> <span class="s1">&#39;rlus&#39;</span><span class="p">,</span> <span class="s1">&#39;rlut&#39;</span><span class="p">,</span> <span class="s1">&#39;rlutcs&#39;</span><span class="p">,</span> <span class="s1">&#39;rsds&#39;</span><span class="p">,</span> <span class="s1">&#39;rsdscs&#39;</span><span class="p">,</span> <span class="s1">&#39;rsdt&#39;</span><span class="p">,</span> <span class="s1">&#39;rsus&#39;</span><span class="p">,</span> <span class="s1">&#39;rsut&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdms&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso2&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">,</span> <span class="s1">&#39;temp&#39;</span><span class="p">,</span> <span class="s1">&#39;vmrdms&#39;</span><span class="p">,</span> <span class="s1">&#39;vmrso2&#39;</span><span class="p">,</span> <span class="s1">&#39;wetbc&#39;</span><span class="p">,</span> <span class="s1">&#39;wetdms&#39;</span><span class="p">,</span> <span class="s1">&#39;wetdust&#39;</span><span class="p">,</span> <span class="s1">&#39;wetoa&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso2&#39;</span><span class="p">,</span> <span class="s1">&#39;wetso4&#39;</span><span class="p">,</span> <span class="s1">&#39;wetss&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="read-aerosol-optical-depth-at-550-nm">
<h4>Read Aerosol optical depth at 550 nm<a class="headerlink" href="#read-aerosol-optical-depth-at-550-nm" title="Permalink to this headline">¶</a></h4>
<p>Import both clear-sky (<em>cs</em> in variable name) and all-sky data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="s1">&#39;CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED&#39;</span><span class="p">)</span>
<span class="n">od550aer</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="n">od550csaer</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s1">&#39;od550csaer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Both data objects are instances of class
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.griddeddata">GriddedData</a>
which is based on the
<a class="reference external" href="https://scitools.org.uk/iris/docs/v1.9.0/html/iris/iris/cube.html#iris.cube.Cube">Cube</a>
class (<a class="reference external" href="https://scitools.org.uk/iris/docs/v1.9.0/html/index.html">iris
library</a>)
and features very similar functionality and more.</p>
<p>Some of these features are introduced below.</p>
</div>
<div class="section" id="overview-of-what-is-in-the-data">
<h4>Overview of what is in the data<a class="headerlink" href="#overview-of-what-is-in-the-data" title="Permalink to this headline">¶</a></h4>
<p>Simply print the object.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">od550aer</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pyaerocom.GriddedData: CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED
Grid data: Aerosol optical depth at 500nm / (1) (time: 84; latitude: 192; longitude: 288)
     Dimension coordinates:
          time                            x             -               -
          latitude                        -             x               -
          longitude                       -             -               x
     Attributes:
          Conventions: CF-1.0
          NCO: 4.3.7
          Version: $Name$
          case: 53OSLO_PD_UNTUNED
          history: Thu Feb  9 11:05:21 2017: ncatted -O -a units,od550aer,o,c,1 /projects/NS2345K/CAM-Oslo/DO_AEROCOM/CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED/renamed/aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED_od550aer_Column_2004_monthly.nc
Thu...
          host: hexagon-2
          initial_file: /work/shared/noresm/inputdata/atm/cam/inic/fv/cami-mam3_0000-01-01_0.9...
          logname: ihkarset
          nco_openmp_thread_number: 1
          revision_Id: $Id$
          source: CAM
          title: UNSET
          topography_file: /work/shared/noresm/inputdata/noresm-only/inputForNudging/ERA_f09f09_3...
     Cell methods:
          mean: time
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">od550csaer</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pyaerocom.GriddedData: CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED
Grid data: Clear air Aerosol optical depth at 550nm / (1) (time: 84; latitude: 192; longitude: 288)
     Dimension coordinates:
          time                                      x             -               -
          latitude                                  -             x               -
          longitude                                 -             -               x
     Attributes:
          Conventions: CF-1.0
          NCO: 4.3.7
          Version: $Name$
          case: 53OSLO_PD_UNTUNED
          history: Thu Feb  9 11:05:16 2017: ncatted -O -a units,od550csaer,o,c,1 /projects/NS2345K/CAM-Oslo/DO_AEROCOM/CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED/renamed/aerocom3_CAM53-Oslo_7310_MG15CLM45_5feb2017IHK_53OSLO_PD_UNTUNED_od550csaer_Column_2004_monthly.nc
Thu...
          host: hexagon-2
          initial_file: /work/shared/noresm/inputdata/atm/cam/inic/fv/cami-mam3_0000-01-01_0.9...
          logname: ihkarset
          nco_openmp_thread_number: 1
          revision_Id: $Id$
          source: CAM
          title: UNSET
          topography_file: /work/shared/noresm/inputdata/noresm-only/inputForNudging/ERA_f09f09_3...
     Cell methods:
          mean: time
</pre></div>
</div>
</div>
<div class="section" id="access-time-stamps">
<h4>Access time stamps<a class="headerlink" href="#access-time-stamps" title="Permalink to this headline">¶</a></h4>
<p>Time stamps are represented as numerical values with respect to a
reference date and frequency, according to the CF conventions. They can
be accessed via the <code class="docutils literal notranslate"><span class="pre">time</span></code> attribute of the data class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer</span><span class="o">.</span><span class="n">time</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DimCoord</span><span class="p">(</span><span class="n">array</span><span class="p">([</span>   <span class="mf">0.</span><span class="p">,</span>   <span class="mf">31.</span><span class="p">,</span>   <span class="mf">60.</span><span class="p">,</span>   <span class="mf">91.</span><span class="p">,</span>  <span class="mf">121.</span><span class="p">,</span>  <span class="mf">152.</span><span class="p">,</span>  <span class="mf">182.</span><span class="p">,</span>  <span class="mf">213.</span><span class="p">,</span>  <span class="mf">244.</span><span class="p">,</span>
        <span class="mf">274.</span><span class="p">,</span>  <span class="mf">305.</span><span class="p">,</span>  <span class="mf">335.</span><span class="p">,</span>  <span class="mf">366.</span><span class="p">,</span>  <span class="mf">397.</span><span class="p">,</span>  <span class="mf">425.</span><span class="p">,</span>  <span class="mf">456.</span><span class="p">,</span>  <span class="mf">486.</span><span class="p">,</span>  <span class="mf">517.</span><span class="p">,</span>
        <span class="mf">547.</span><span class="p">,</span>  <span class="mf">578.</span><span class="p">,</span>  <span class="mf">609.</span><span class="p">,</span>  <span class="mf">639.</span><span class="p">,</span>  <span class="mf">670.</span><span class="p">,</span>  <span class="mf">700.</span><span class="p">,</span>  <span class="mf">731.</span><span class="p">,</span>  <span class="mf">762.</span><span class="p">,</span>  <span class="mf">790.</span><span class="p">,</span>
        <span class="mf">821.</span><span class="p">,</span>  <span class="mf">851.</span><span class="p">,</span>  <span class="mf">882.</span><span class="p">,</span>  <span class="mf">912.</span><span class="p">,</span>  <span class="mf">943.</span><span class="p">,</span>  <span class="mf">974.</span><span class="p">,</span> <span class="mf">1004.</span><span class="p">,</span> <span class="mf">1035.</span><span class="p">,</span> <span class="mf">1065.</span><span class="p">,</span>
       <span class="mf">1096.</span><span class="p">,</span> <span class="mf">1127.</span><span class="p">,</span> <span class="mf">1155.</span><span class="p">,</span> <span class="mf">1186.</span><span class="p">,</span> <span class="mf">1216.</span><span class="p">,</span> <span class="mf">1247.</span><span class="p">,</span> <span class="mf">1277.</span><span class="p">,</span> <span class="mf">1308.</span><span class="p">,</span> <span class="mf">1339.</span><span class="p">,</span>
       <span class="mf">1369.</span><span class="p">,</span> <span class="mf">1400.</span><span class="p">,</span> <span class="mf">1430.</span><span class="p">,</span> <span class="mf">1461.</span><span class="p">,</span> <span class="mf">1492.</span><span class="p">,</span> <span class="mf">1521.</span><span class="p">,</span> <span class="mf">1552.</span><span class="p">,</span> <span class="mf">1582.</span><span class="p">,</span> <span class="mf">1613.</span><span class="p">,</span>
       <span class="mf">1643.</span><span class="p">,</span> <span class="mf">1674.</span><span class="p">,</span> <span class="mf">1705.</span><span class="p">,</span> <span class="mf">1735.</span><span class="p">,</span> <span class="mf">1766.</span><span class="p">,</span> <span class="mf">1796.</span><span class="p">,</span> <span class="mf">1827.</span><span class="p">,</span> <span class="mf">1858.</span><span class="p">,</span> <span class="mf">1886.</span><span class="p">,</span>
       <span class="mf">1917.</span><span class="p">,</span> <span class="mf">1947.</span><span class="p">,</span> <span class="mf">1978.</span><span class="p">,</span> <span class="mf">2008.</span><span class="p">,</span> <span class="mf">2039.</span><span class="p">,</span> <span class="mf">2070.</span><span class="p">,</span> <span class="mf">2100.</span><span class="p">,</span> <span class="mf">2131.</span><span class="p">,</span> <span class="mf">2161.</span><span class="p">,</span>
       <span class="mf">2192.</span><span class="p">,</span> <span class="mf">2223.</span><span class="p">,</span> <span class="mf">2251.</span><span class="p">,</span> <span class="mf">2282.</span><span class="p">,</span> <span class="mf">2312.</span><span class="p">,</span> <span class="mf">2343.</span><span class="p">,</span> <span class="mf">2373.</span><span class="p">,</span> <span class="mf">2404.</span><span class="p">,</span> <span class="mf">2435.</span><span class="p">,</span>
       <span class="mf">2465.</span><span class="p">,</span> <span class="mf">2496.</span><span class="p">,</span> <span class="mf">2526.</span><span class="p">]),</span> <span class="n">standard_name</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;days since 2004-01-01 00:00:00&#39;</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>You may also want the time-stamps in the form of actual datetime-like
objects. These can be computed using the <code class="docutils literal notranslate"><span class="pre">time_stamps()</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2004-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2004-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2004-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2004-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2004-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2004-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2004-12-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-12-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2006-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2006-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2006-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2006-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2006-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2006-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2006-12-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2007-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2007-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2007-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2007-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2007-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2007-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-12-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2008-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2008-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2008-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2008-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2008-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2008-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2008-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2008-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2008-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2008-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2008-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2008-12-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2009-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2009-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2009-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2009-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2009-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2009-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2009-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2009-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2009-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2009-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2009-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2009-12-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2010-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2010-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2010-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2010-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2010-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2010-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2010-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2010-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2010-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2010-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2010-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2010-12-01T00:00:00.000000&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[us]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-maps">
<h4>Plotting maps<a class="headerlink" href="#plotting-maps" title="Permalink to this headline">¶</a></h4>
<p>Maps of individual time stamps can be plotted using the quickplot_map
method.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax1</span> <span class="o">=</span> <span class="n">od550aer</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009-3-15&#39;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">od550csaer</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009-3-15&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_23_0.png" src="_images/tut00_get_started_23_0.png" />
<img alt="_images/tut00_get_started_23_1.png" src="_images/tut00_get_started_23_1.png" />
</div>
<div class="section" id="filtering">
<h4>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h4>
<p>Regional filtering can be performed using the
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.filter">Filter</a>
class (cf.&nbsp;flowchart above).</p>
<p>An overview of available default regions can be accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">get_all_default_region_ids</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;WORLD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUROPE&#39;</span><span class="p">,</span> <span class="s1">&#39;ASIA&#39;</span><span class="p">,</span> <span class="s1">&#39;AUSTRALIA&#39;</span><span class="p">,</span> <span class="s1">&#39;CHINA&#39;</span><span class="p">,</span> <span class="s1">&#39;INDIA&#39;</span><span class="p">,</span> <span class="s1">&#39;NAFRICA&#39;</span><span class="p">,</span> <span class="s1">&#39;SAFRICA&#39;</span><span class="p">,</span> <span class="s1">&#39;SAMERICA&#39;</span><span class="p">,</span> <span class="s1">&#39;NAMERICA&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now let’s go for north Africa. Create instance of Filter class:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Filter</span><span class="p">(</span><span class="s1">&#39;NAFRICA&#39;</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Filter</span><span class="p">([(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;NAFRICA-wMOUNTAINS&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;_region&#39;</span><span class="p">,</span>
         <span class="n">Region</span> <span class="n">NAFRICA</span> <span class="n">Region</span><span class="p">([(</span><span class="s1">&#39;_name&#39;</span><span class="p">,</span> <span class="s1">&#39;NAFRICA&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;lon_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;lat_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;lon_range_plot&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;lat_range_plot&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;lon_ticks&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;lat_ticks&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])),</span>
        <span class="p">(</span><span class="s1">&#39;lon_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]),</span>
        <span class="p">(</span><span class="s1">&#39;lat_range&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">]),</span>
        <span class="p">(</span><span class="s1">&#39;alt_range&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)])</span>
</pre></div>
</div>
<p>… and apply to the two data objects (this can be done by calling the
filter with the corresponding data class as input parameter):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">od550aer</span><span class="p">)</span>
<span class="n">od550csaer_nafrica</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">od550csaer</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare shapes:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">500</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">84</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">42</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">57</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">500</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">84</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">288</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>As you can see, the filtered object is reduced in the longitude and
latitude dimension. Let’s plot the two new objects:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax1</span> <span class="o">=</span> <span class="n">od550aer_nafrica</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009-3-15&#39;</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">od550csaer_nafrica</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009-3-15&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_34_0.png" src="_images/tut00_get_started_34_0.png" />
<img alt="_images/tut00_get_started_34_1.png" src="_images/tut00_get_started_34_1.png" />
</div>
<div class="section" id="filtering-of-time">
<h4>Filtering of time<a class="headerlink" href="#filtering-of-time" title="Permalink to this headline">¶</a></h4>
<p>Filtering of time is not yet included in the Filter class but can be
easily performed from the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> object directly. If you know
the indices of the time stamps you want to crop, you can simply use
numpy indexing syntax (remember that we have a 3D array containing time,
latitude and lonfgitude).</p>
<p>Let’s say we want to filter the <strong>year 2009</strong>.</p>
<p>Since the time dimension corresponds the first index in the 3D data
(time, lat, lon), and since we know, that we have monthly data from
2008-2010 (see above), we may use</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica_2009</span> <span class="o">=</span> <span class="n">od550aer_nafrica</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span>
<span class="n">od550aer_nafrica_2009</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2005-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-12-01T00:00:00.000000&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[us]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>in order to extract the year 2009.</p>
<p>However, this methodology might not always be handy (imagine you have a
10 year dataset of <code class="docutils literal notranslate"><span class="pre">3hourly</span></code> sampled data and want to extract three
months in the 6th year …). In that case, you can perform the cropping
using the actual timestamps (for comparibility, let’s stick to 2009
here):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica_2009_alt</span> <span class="o">=</span> <span class="n">od550aer_nafrica</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">time_range</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;1-1-2009&#39;</span><span class="p">,</span> <span class="s1">&#39;1-1-2010&#39;</span><span class="p">))</span>
<span class="n">od550aer_nafrica_2009</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2005-01-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-02-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-03-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-04-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-05-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-06-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-07-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-08-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-09-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-10-01T00:00:00.000000&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2005-11-01T00:00:00.000000&#39;</span><span class="p">,</span> <span class="s1">&#39;2005-12-01T00:00:00.000000&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[us]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="data-aggregation">
<h4>Data aggregation<a class="headerlink" href="#data-aggregation" title="Permalink to this headline">¶</a></h4>
<p>Let’s say we want to compute yearly means for each of the 3 years. In
this case we can simply call the <code class="docutils literal notranslate"><span class="pre">downscale_time</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">od550aer_nafrica</span><span class="o">.</span><span class="n">downscale_time</span><span class="p">(</span><span class="s1">&#39;yearly&#39;</span><span class="p">)</span>
<span class="n">od550aer_nafrica</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="s1">&#39;2009&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_41_0.png" src="_images/tut00_get_started_41_0.png" />
<img alt="_images/tut00_get_started_41_1.png" src="_images/tut00_get_started_41_1.png" />
<p><strong>Note</strong>: seasonal aggregation is not yet implemented in pyaerocom but
will follow soon.</p>
<p>In the following section the reading of ungridded data is illustrated
based on the example of AERONET version 3 (level 2) data. The test
dataset contains a randomly picked subset of 100 Aeronet stations.
Aeronet provides different products,</p>
</div>
</div>
<div class="section" id="reading-of-and-working-with-ungridded-data-readungridded-and-ungriddeddata-classes">
<h3>Reading of and working with ungridded data (<code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> and <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> classes)<a class="headerlink" href="#reading-of-and-working-with-ungridded-data-readungridded-and-ungriddeddata-classes" title="Permalink to this headline">¶</a></h3>
<p>Ungridded data in pyaerocom refers to data that is available in the form
of <em>files per station</em> and that is not sampled in a manner that it would
make sense to translate into a rgular gridded format such as the
previously introduced <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class.</p>
<p>Data from the AERONET network (that is introduced in the following), for
instance, is provided in the form of column seperated text files per
measurement station, where columns correspond to different variables and
data rows to individual time stamps. Needless to say that the time
stamps (or the covered periods) vary from station to station.</p>
<p>The basic workflow for reading of ungridded data, such as Aeronet data,
is very similar to the reading of gridded data (comprising a reading
class that handles a query and returns a data class, here
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.ungriddeddata">UngriddedData</a>
(see also flow chart above).</p>
<p>Before we can continue with the data import, some things need to be said
related to the caching of <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> objects.</p>
<div class="section" id="caching-of-ungriddeddata">
<h4>Caching of UngriddedData<a class="headerlink" href="#caching-of-ungriddeddata" title="Permalink to this headline">¶</a></h4>
<p>Reading of ungridded data is often rather time-consuming. Therefore,
pyaerocom uses a caching strategy that stores loaded instances of the
<code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> class as pickle files in a cache directory
(illustrated in the left hand side of the flowchart shown above). The
loaction of the cache directory can be accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHEDIR</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;/home/jonasg/pyaerocom/_cache/jonasg&#39;</span>
</pre></div>
</div>
<p>You may change this directory if required.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Caching is active? </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHING</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Caching is active? True
</pre></div>
</div>
<p><strong>Deactivate caching</strong></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHING</span> <span class="o">=</span> <span class="kc">False</span>
</pre></div>
</div>
<p><strong>Activate caching</strong></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">CACHING</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
<p><strong>Note</strong>: if caching is active, make sure you have enough disk quota or
change location where the files are stored.</p>
</div>
<div class="section" id="read-aeronet-sun-v3-level-2-data">
<h4>Read Aeronet Sun v3 level 2 data<a class="headerlink" href="#read-aeronet-sun-v3-level-2-data" title="Permalink to this headline">¶</a></h4>
<p>As illustrated in the flowchart above, ungridded observation data can be
imported using the <code class="docutils literal notranslate"><span class="pre">ReadUngridded</span></code> class. The reading class requires
an ID for the observation network that is supposed to be read. Let’s
find the right ID for these data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">browse_database</span><span class="p">(</span><span class="s1">&#39;Aeronet*V3*Lev2*&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20180820</span>
<span class="n">Reading</span> <span class="n">failed</span> <span class="k">for</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">AP</span><span class="o">.</span> <span class="n">Error</span><span class="p">:</span> <span class="ne">OSError</span><span class="p">(</span><span class="s1">&#39;Data directory /lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/AeronetSunV3Lev2.0.AP/renamed of observation network AeronetSunV3Lev2.AP does not exists&#39;</span><span class="p">,)</span>

<span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSDAV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">SDA</span><span class="o">.</span><span class="n">V3L2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od500gt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550gt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20180928</span>
<span class="n">Reading</span> <span class="n">failed</span> <span class="k">for</span> <span class="n">AeronetSDAV3Lev2</span><span class="o">.</span><span class="n">AP</span><span class="o">.</span> <span class="n">Error</span><span class="p">:</span> <span class="n">NetworkNotImplemented</span><span class="p">(</span><span class="s1">&#39;No reading class available yet for dataset AeronetSDAV3Lev2.AP&#39;</span><span class="p">,)</span>

<span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetInvV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">Aeronet</span><span class="o">.</span><span class="n">Inv</span><span class="o">.</span><span class="n">V3L2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;angabs4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20180728</span>
</pre></div>
</div>
<p>It found one match and the dataset ID is <em>AeronetSunV3Lev2.daily</em>. It
also tells us what variables can be loaded via the interface.</p>
<p><strong>Note</strong>: You can safely ignore all the warnings in the output. These
are due to the fact that the testdata set does not contain all
observation networks that are available in the AEROCOM database.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="p">(</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs_reader</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Dataset</span> <span class="n">name</span><span class="p">:</span> <span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="n">daily</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">AEROCOM_OBSDATA</span><span class="o">/</span><span class="n">AeronetSunV3Lev2</span><span class="o">.</span><span class="mf">0.</span><span class="n">daily</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Supported</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od340aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od500aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer_calc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Last</span> <span class="n">revision</span><span class="p">:</span> <span class="mi">20180820</span>
</pre></div>
</div>
<p>Let’s read the data (you can read a single or multiple variables at the
same time). For now, we only read the AOD at 550 nm:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aeronet_data</span> <span class="o">=</span> <span class="n">obs_reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">vars_to_retrieve</span><span class="o">=</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">aeronet_data</span><span class="p">)</span> <span class="c1">#displays data type</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">ungriddeddata</span><span class="o">.</span><span class="n">UngriddedData</span>
</pre></div>
</div>
<p>As you can see, the data object is of type <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code>. Like the
<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> object, also the <code class="docutils literal notranslate"><span class="pre">UngriddedData</span></code> class has an
informative string representation (that can be printed):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">aeronet_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">UngriddedData</span>
<span class="o">-----------------------</span>
<span class="n">Contains</span> <span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">]</span>
<span class="n">Total</span> <span class="n">no</span><span class="o">.</span> <span class="n">of</span> <span class="n">stations</span><span class="p">:</span> <span class="mi">1165</span>
</pre></div>
</div>
</div>
<div class="section" id="access-of-individual-stations">
<h4>Access of individual stations<a class="headerlink" href="#access-of-individual-stations" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aeronet_data</span><span class="o">.</span><span class="n">station_name</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;AOE_Baotou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Ascension_Is&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Barnstable_MA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Darwin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Gan_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Graciosa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Highlands_MA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_HyytialaFinland&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Manacapuru&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_McMurdo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Nainital&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_Oliktok_AK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ARM_WAIS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ATHENS-NOA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Abisko&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Abracos_Hill&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Abu_Al_Bukhoosh&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Abu_Dhabi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Adelaide_Site_7&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AgiaMarina_Xyliatou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Agoufou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Agri_School&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Aguas_Emendadas&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Aguascalientes&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ahi_De_Cara&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ahmedabad&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Aire_Adour&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Al_Ain&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Al_Dhafra&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Al_Khaznah&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Al_Qlaa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Albergue_UGR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Alboran&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Albuquerque&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Alishan&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Alta_Floresta&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Amazon_ATTO_Tower&#39;</span><span class="p">,</span>
 <span class="s1">&#39;American_Samoa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ames&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Amsterdam_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Andenes&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Andros_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Angiola&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Anmyon&#39;</span><span class="p">,</span>
 <span class="s1">&#39;AntarcticaDomeC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Appalachian_State&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Appledore_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Apra_Harbor&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Aras_de_los_Olmos&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Arcachon&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Arica&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ariquiums&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Arizona&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Armilla&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ascension_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Asia1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Aubiere_LAMP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Autilla&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Avignon&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Azores&#39;</span><span class="p">,</span>
 <span class="s1">&#39;BMKG_GAW_PALU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;BONDVILLE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;BORDEAUX&#39;</span><span class="p">,</span>
 <span class="s1">&#39;BSRN_BAO_Boulder&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bac_Giang&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bac_Lieu&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bach_Long_Vy&#39;</span><span class="p">,</span>
 <span class="s1">&#39;BackGarden_GZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Badajoz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Baengnyeong&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bahrain&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bakersfield&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Balbina&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bambey-ISRA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bamboo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bandung&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Baneasa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Banizoumbou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Barbados&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Barbados_SALTRACE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Barcelona&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bareilly&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bari_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Barnaul&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Barrow&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Baskin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bayfordbury&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Beijing-CAMS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Beijing&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Beijing_RADI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Belsk&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Belterra&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ben_McDhui&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ben_Salem&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Berlin_FUB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bermuda&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bethlehem&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bhola&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Biarritz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bidi_Bahn&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Big_Meadows&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Billerica&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Birdsville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Birkenes&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Black_Forest_AMF&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Blida&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Blyth_NOAH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bodele&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bolzano&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bonanza&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bonanza_Creek&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bondoukoui&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bordj_Badji_Mokhtar&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bordman&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bose_Institute&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Boulder&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Boyd_County_MS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bozeman&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bragansa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Brasilia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bratts_Lake&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Brisbane-Uni_of_QLD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Brno_Airport&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Brookhaven&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Brussels&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bucarest&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bucharest_Inoe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Buena_Vista&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Buesum&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bujumbura&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bure_OPE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Burjassot&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Burtonsville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Bushland&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CAMPO_VERDE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CANDLE_LAKE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CARTEL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CART_SITE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CASLEO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CATUC_Bamenda&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CBBT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CCNY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CEILAP-BA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CEILAP-Bariloche&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CEILAP-Comodoro&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CEILAP-Neuquen&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CEILAP-RG&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CEILAP-UTN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CLUJ_UBB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;COVE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;COVE_SEAPRISM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CRPSM_Malindi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CRYSTAL_FACE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CUIABA-MIRANDA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CUT-TEPAK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cabauw&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cabo_Raso&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cabo_da_Roca&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Caceres&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cagliari&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cairo_EMA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cairo_EMA_2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cairo_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CalTech&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Caldwell_Parish_HS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calern_OCA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calhau&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Bowers_Rd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Brookview&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Carthage&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Church_H_Rd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Church_Hill&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Crouse_Mill&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Dean_Rd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Flat_Iron&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Harrison_Rd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Hillsboro&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Hillsboro_E&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Hurlock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Kennedyvill&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Kinchaloe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Loudon_Rd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Mardela_Spr&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Morgnec_Rd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_NUFerry_Rd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Ninetown_Rd&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Ormand_MS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Peckman_Frm&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Perryville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Pine_Cove&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Price&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Princess_An&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Prt_Deposit&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Ridgely&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Sabine_Frst&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Sanders_ES&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Sterling_PO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Strasburg&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Tuckahoe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Vienna&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_W_Mardela&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_W_Strasburg&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Washtn_High&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_West_Denton&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Westfield_H&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_White_Marsh&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_WillistonLk&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_WofDenton&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Calipso_Zion&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Camaguey&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Camborne_MO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Campo_Grande&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Campo_Grande_SONDA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Canberra&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cap_d_En_Font&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cape_Romain&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cape_San_Juan&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Capo_Verde&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Carloforte&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Carlsbad&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Carpentras&#39;</span><span class="p">,</span>
 <span class="s1">&#39;CART_SITE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cat_Spring&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cerro_Poyos&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chao_Jou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chapada&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chapais&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chebogue_Point&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chen-Kung_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chequamegon&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chiang_Mai&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chiang_Mai_Met_Sta&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chiayi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chiba_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chilbolton&#39;</span><span class="p">,</span>
 <span class="s1">&#39;China_Lake&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chinhae&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Chulalongkorn&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Churchill&#39;</span><span class="p">,</span>
 <span class="s1">&#39;City_GZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Clermont_Ferrand&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Coconut_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cold_Lake&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Coleambally&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Columbia_SC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Concepcion&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Corcoran&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cordoba-CETT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cork_UCC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Coruna&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Creteil&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Crozet_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Cuiaba&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DMN_Maine_Soroa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_ABERD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_ANNEA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_ARNCC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_ARNLS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Aldine&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Aldino&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Anmyeon&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Arvin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Aurora_East&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_BATMR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_BLDND&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_BLLRT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_BLTCC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_BLTIM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_BLTNR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_BOWEM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_BTMDL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Bainbridge&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Bakersfield&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_BelAir&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Beltsville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Bokjeong&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Boulder&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_CHASE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_CLLGP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_CLRST&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_CPSDN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_CTNVL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Channel_View&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Chatfield_Pk&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Clinton&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Clovis&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Conroe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Corcoran&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Deer_Park&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_DenverLaCasa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Drummond&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_EDCMS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_ELLCT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_EaglePoint&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Edgewood&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Essex&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_FLLST&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_FairHill&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Fort_Collins&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Fukue&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Fukue_2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Fukue_3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Fukuoka&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Galveston&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Galveston_DP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_GangneungWNU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Garland&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Guwol&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Gwangju_GIST&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Hanford&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Hankuk_UFS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Henties_1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Henties_2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Henties_3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Henties_4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Henties_5&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Henties_6&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Huron&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Jalan_ChainF&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_KampungBharu&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_KentIsland&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Kobe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Kohriyama&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Kongju_NU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Konkuk_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Korea_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Kunsan_NU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Kyoto&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Kyungil_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_LAREL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_LAUMD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_MNKTN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Madera_City&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_ManvelCroix&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Matsue&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Mokpo_NU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Mt_Ikoma&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Mt_Rokko&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_NIER&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_NREL-Golden&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_NW_Harris_CO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Nara&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Nishiharima&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Niwot_Ridge&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_OLNES&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_ONNGS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Osaka-North&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Osaka-South&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Osaka_Center&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_PATUX&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Padonia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Pandan_Resrv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Parlier&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Pasadena&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_PayaTerubong&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Permatang_DL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_PineyOrchard&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Platteville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Pondok_Upeh&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Porterville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Pusan_NU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Pylesville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_RCKMD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Rocky_Flats&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_SHADY&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_SPBRK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Sanggye&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_SeabrookPark&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Shafter&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Sinjeong&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Smith_Point&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Soha&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_St_Johns_Is&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_TKMPR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Temasek_Poly&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Tranquility&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Tsukuba&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_UH_Sugarland&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_UH_W_Liberty&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_UMRLB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_UiTM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Visalia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_WSTFD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Welch&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Weld_Co_Twr&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_West_Houston&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_WileyFord&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Worton&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DRAGON_Yishun_ITE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dahkla&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dakar&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dalanzadgad&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dalma&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Darwin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Davos&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dayton&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dead_Sea&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Denver_LaCasa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dhabi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dhadnah&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dhaka_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;DigitalGlobe_Cal&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dilar&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Djougou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Doi_Ang_Khang&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dolly_Sods&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Donetsk&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dongsha_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Douliu&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dry_Tortugas&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dunedin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dunhuang&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dunhuang_LZU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dunkerque&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Durban_UKZN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Dushanbe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EOPACE1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EOPACE2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EPA-NCU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EPA-Res_Triangle_Pk&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ETNA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EVK2-CNR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;EastMalling_MO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Easton-MDE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Easton_Airport&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Edinburgh&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Eforie&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Egbert&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Egbert_X&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Eilat&#39;</span><span class="p">,</span>
 <span class="s1">&#39;El_Arenosillo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;El_Farafra&#39;</span><span class="p">,</span>
 <span class="s1">&#39;El_Nido_Airport&#39;</span><span class="p">,</span>
 <span class="s1">&#39;El_Segundo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Elandsfontein&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ellington_Field&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Epanomi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ersa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Etosha_Pan&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Evora&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Exeter_MO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FLIN_FLON&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FORTH_CRETE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;FZJ-JOYCE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Farmington_RSVP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Finokalia-FKL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fontainebleau&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fort_McKay&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fort_McMurray&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fowlers_Gap&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Frenchman_Flat&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fresno&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fresno_2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fresno_X&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Frioul&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fuguei_Cape&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fukue&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Fukuoka&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GISS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GORDO_rest&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GOT_Seaprism&#39;</span><span class="p">,</span>
 <span class="s1">&#39;GSFC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gageocho_Station&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gainesville_Airport&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gaithersburg&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Galata_Platform&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gandhi_College&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gangneung_WNU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Georgia_Tech&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Glasgow_MO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gloria&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gobabeb&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Goldstone&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gorongosa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gosan_SNU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gotland&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gozo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Graciosa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Granada&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Grand_Forks&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Guadeloup&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gual_Pahari&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Guam&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gustav_Dalen_Tower&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Gwangju_GIST&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HESS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HJAndrews&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HOPE-Hambach&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HOPE-Inselhombroich&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HOPE-Krauthausen&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HOPE-Melpitz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HOPE-RWTH-Aachen&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hada_El-Sham&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hagerstown&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Halifax&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hamburg&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hamim&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hampton_Roads&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hampton_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hangzhou-ZFU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hangzhou_City&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hankuk_UFS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Harvard_Forest&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hefei&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Helgoland&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Helsinki&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Helsinki_Lighthouse&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Heng-Chun&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Henties_Bay&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hermosillo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hetauda&#39;</span><span class="p">,</span>
 <span class="s1">&#39;HohenpeissenbergDWD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hokkaido_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Homburi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hong_Kong_Hok_Tsui&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hong_Kong_PolyU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hong_Kong_Sheung&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Honolulu&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hornsund&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Howland&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hua_Hin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Huancayo-IGP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Huelva&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Hyytiala&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IAOCA-KRSU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IASBS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ICIPE-Mbita&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IER_Cinzana&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IHOP-Homestead&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IIT_KGP_EXT_Kolkata&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IMAA_Potenza&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IMC_Oristano&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IMPROVE-MammothCave&#39;</span><span class="p">,</span>
 <span class="s1">&#39;IMS-METU-ERDEMLI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ISDGM_CNR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Iasi_LOASL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ieodo_Station&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ilorin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Inhaca&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Inner_Mongolia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Iqaluit&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Irkutsk&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ispra&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Issyk-Kul&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Itajuba&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ittoqqortoormiit&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Izana&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jabal_Hafeet&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jabiru&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jaipur&#39;</span><span class="p">,</span>
 <span class="s1">&#39;JamTown&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jambi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;James_Res_Center&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jaru_Reserve&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ji_Parana&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ji_Parana_SE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ji_Parana_UNIR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jingtai&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Joberg&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jomsom&#39;</span><span class="p">,</span>
 <span class="s1">&#39;JonesERC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Jug_Bay&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KAUST_Campus&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KIOST_Ansan&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KITcube_Masada&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KITcube_Save&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KONZA_EDC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_Baeksa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_Daegwallyeong&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_Iksan&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_Kyungpook_NU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_Mokpo_NU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_NIER&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_Olympic_Park&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_Songchon&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_Taehwa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;KORUS_UNIST_Ulsan&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kaashidhoo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kaiping&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kandahar&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kangerlussuaq&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kanpur&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kanzelhohe_Obs&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kaoma&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kapoho&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Karachi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Karlsruhe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Karunya_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kathmandu-Bode&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kathmandu_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Katibougou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kejimkujik&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kellogg_LTER&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kelowna_UAS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Key_Biscayne&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Key_Biscayne2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kibale&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kirtland_AFB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kitt-Peak_MP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kobe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Koforidua_ANUC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kolimbari&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Konza&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Korea_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Krasnoyarsk&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kuching&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kuopio&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kuujjuarapik&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kuwait_Airport&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kuwait_Inst_Sci_Res&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kuwait_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kyiv-AO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kyiv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Kyungil_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;LAMTO-STATION&#39;</span><span class="p">,</span>
 <span class="s1">&#39;LAQUILA_Coppito&#39;</span><span class="p">,</span>
 <span class="s1">&#39;LISCO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;LMOS_Zion_Site&#39;</span><span class="p">,</span>
 <span class="s1">&#39;LOS_FIEROS_98&#39;</span><span class="p">,</span>
 <span class="s1">&#39;LSU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;LW-SCAN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;La_Crau&#39;</span><span class="p">,</span>
 <span class="s1">&#39;La_Jolla&#39;</span><span class="p">,</span>
 <span class="s1">&#39;La_Laguna&#39;</span><span class="p">,</span>
 <span class="s1">&#39;La_Parguera&#39;</span><span class="p">,</span>
 <span class="s1">&#39;La_Paz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Laegeren&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lahore&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lake_Argyle&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lake_Erie&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lake_Lefroy&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lamezia_Terme&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lampedusa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lan_Yu_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lanai&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Langtang&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lannion&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lanzhou_City&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Las_Galletas&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Le_Fauga&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lecce_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Leicester&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Leipzig&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Leland_HS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lerwick_MO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Liangning&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lille&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lingshan_Mountain&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Litang&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lochiel&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Loftus_MO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;London-UCL-UAO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Longyearbyen&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Los_Alamos&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Los_Fieros&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Loskop_Dam&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Luang_Namtha&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lubango&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lucinda&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lugansk&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lulin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lumbini&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Lunar_Lake&#39;</span><span class="p">,</span>
 <span class="s1">&#39;MAARCO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;MALE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;MCO-Hanimaadhoo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;MD_Science_Center&#39;</span><span class="p">,</span>
 <span class="s1">&#39;MISR-JPL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;MPI_Mainz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;MVCO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mace_Head&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Madison&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Madrid&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Maeson&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Maggie_Valley&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Magurele_Inoe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mainz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Makassar&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Malaga&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mammoth_Lake&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Manaus&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Manaus_EMBRAPA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Manila_Observatory&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Manus&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Marambio&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Marbella_San_Pedro&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Maricopa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Marina&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Marseille&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Martova&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Masdar_Institute&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Maun_Tower&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mauna_Loa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;McClellan_AFB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;McMurdo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Medellin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Medenine-IRA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Melpitz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Merredin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mesa_Lakes&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Messina&#39;</span><span class="p">,</span>
 <span class="s1">&#39;MetObs_Lindenberg&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mexico_City&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mezaira&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Miami&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Midway_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Milyering&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mingo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Minqin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Minsk&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Misamfu&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Missoula&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_C_050608&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_C_060708&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_DDun_051308W&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_Kanpur_East&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_Kanpur_SE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_Kanpur_South&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_Kanpur_W2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_Kanpur_West&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_N_050608&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_N_051308W&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_N_051508E&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_N_052908W&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_N_053108E&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_N_060708&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_N_061408W&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_S_011509_ND&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_S_050608&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_S_051308W&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_S_051508E&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_S_052908W&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_S_060708&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mobile_S_062308&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Modena&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Modesto&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Moldova&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Monclova&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mongu&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mongu_Inn&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mont_Joli&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Monterey&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Montesoro_Bastia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Montsec&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Moscow_MSU_MO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Moss_Landing&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mount_Chacaltaya&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mount_Wilson&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mukdahan&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Munich_Maisach&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Munich_University&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Murcia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Muscat&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mussafa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Muztagh_Ata&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Mwinilunga&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Myanmar&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NAM_CO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NASA_Ames&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NASA_KSC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NASA_LaRC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NCU_Taiwan&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ND_Marbel_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON-Boulder&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON-CPER&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON-Disney&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON-HQ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON-SoaprootSaddle&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON17-SJER&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_Bartlett&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_CLBJ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_CVALLA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_DEJU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_GRSM&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_GUAN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_GrandJunction&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_HEAL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_Harvard&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_HarvardForest&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_HighParkFire&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_Ivanpah&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_KONZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_LENO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_MLBS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_MOAB&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_OAES&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_ONAQ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_ORNL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_OSBS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_RMNP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_SCBI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_SERC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_Sterling&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_TALL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_TOOL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_UKFS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_UNDE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEON_WOOD&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NEW_YORK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NGHIA_DO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NSA_YJP_BOREAS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NUIST&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NW_Chapel_Hill&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nainital&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nairobi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Namibe&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Napoli_CeSMA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nara&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Narsarsuaq&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Natal&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nauru&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ndola&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nes_Ziona&#39;</span><span class="p">,</span>
 <span class="s1">&#39;New_Delhi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;New_Hampshire_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;NhaTrang&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Niabrara&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Niamey&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nicelli_Airport&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nicosia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Niigata&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nong_Khai&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Norfolk_State_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;North_Pole&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Noto&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Noumea&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Nouragues&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ny_Alesund&#39;</span><span class="p">,</span>
 <span class="s1">&#39;OBERNAI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;OBS-SSA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;OHP_OBSERVATOIRE&#39;</span><span class="p">,</span>
 <span class="s1">&#39;OK_St_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;OPAL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ORS_Hermosillo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;ORS_UNAM_ISNP&#39;</span><span class="p">,</span>
 <span class="s1">&#39;OkefenokeeNWR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Okinawa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Omkoi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Oostende&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ordway-Swisher&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Orizaba&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Orlean_Bricy&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Osaka-North&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Osaka&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ouagadougou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ouarzazate&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Oujda&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Oukaimeden&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Owens_Lake&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Oxford&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Oyster&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PEARL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PKU_PEK&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PNNL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;POLWET_Rzecin&#39;</span><span class="p">,</span>
 <span class="s1">&#39;PRINCE_ALBERT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Paardefontein&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Paddockwood&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pafos&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pagosa_Springs&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Palaiseau&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Palangkaraya&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Palencia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Palgrunden&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Palma_de_Mallorca&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Panama_BCI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pantanal&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pantnagar&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Paposo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Paracou&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Paris&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Park_Brasilia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Penn_State_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Perth&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Peterhof&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Petrolina_SONDA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Philadelphia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pic_du_midi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pickle_Lake&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pietersburg&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pimai&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pitres&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pokhara&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pontianak&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Poprad-Ganovce&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Porquerolles&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Portglenone_MO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Porto_Nacional&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Porto_Velho&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Porto_Velho_UNIR&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Possession_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Potchefstroom&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Potosi_Mine&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Praia&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pretoria_CSIR-DPSS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Progress&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Prospect_Hill&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Puerto_Madryn&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Puli&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pullman&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pune&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Pusan_NU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Puspiptek&#39;</span><span class="p">,</span>
 <span class="s1">&#39;QOMS_CAS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Qiandaohu&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Quarzazate&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Quito_USFQ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;REUNION_ST_DENIS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Raciborz&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ragged_Point&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Railroad_Valley&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rame_Head&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Ras_El_Ain&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Realtor&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Red_Bluff&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Red_Mountain_Pass&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Red_River_Delta&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Resolute_Bay&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rexburg_Idaho&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rhyl_MO&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Richland&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rimrock&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rio_Branco&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rio_Piedras&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rio_de_Janeiro_UFRJ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rogers_Dry_Lake&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rome_ESA_ESRIN&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rome_La_Sapienza&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rome_Tor_Vergata&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Roosevelt_Roads&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rossfeld&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Rottnest_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SACOL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SAGRES&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SANTA_CRUZ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SANTA_CRUZ_UTEPSA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SDU1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SDU2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SDU3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SDU4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SEARCH-Centreville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SEARCH-Centreville2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SEARCH-OLF&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SEARCH-Yorkville&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SEDE_BOKER&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SEGC_Lope_Gabon&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SERC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SKUKUZA_AEROPORT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SMART&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SMART_POL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SMEX&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SMHI&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SP-EACH&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SP_Bayboro&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SSA_YJP_BOREAS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;SS_OJP_BOREAS&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Saada&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sable_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Saih_Salam&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Saint_Mandrier&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Salon_de_Provence&#39;</span><span class="p">,</span>
 <span class="s1">&#39;San_Giuliano&#39;</span><span class="p">,</span>
 <span class="s1">&#39;San_Nicolas&#39;</span><span class="p">,</span>
 <span class="s1">&#39;San_Nicolas_Vandal&#39;</span><span class="p">,</span>
 <span class="s1">&#39;San_Pietro_Capo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sandia_NM_PSEL&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Santa_Cruz_Tenerife&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Santa_Monica_Colg&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Santarem&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Santiago&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Santiago_Beauchef&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sao_Martinho_SONDA&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sao_Paulo&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Saturn_Island&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Senanga&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Seoul_SNU&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sesheke&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sevastopol&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sevilleta&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Seysses&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Shagaya_Park&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Shelton&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Shirahama&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Shouxian&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sigma_Space_Corp&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Silpakorn_Univ&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Simonstown_IMT&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Singapore&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sinhgad&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sioux_Falls&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sioux_Falls_X&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sir_Bu_Nuair&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sirmione_Museo_GC&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Skukuza&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Smith_Island_CBF&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Socheongcho&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Sodankyla&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Solar_Village&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Solwezi&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Son_La&#39;</span><span class="p">,</span>
 <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>Let’s say you are interested in the city of Leipzig, Germany.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span> <span class="o">=</span> <span class="n">aeronet_data</span><span class="p">[</span><span class="s1">&#39;Leipzig&#39;</span><span class="p">]</span>
<span class="nb">type</span><span class="p">(</span><span class="n">station_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">stationdata</span><span class="o">.</span><span class="n">StationData</span>
</pre></div>
</div>
<p>As you can see, the returned object is of type <code class="docutils literal notranslate"><span class="pre">StationData</span></code>, which is
one further data format that is not displayed in the flowchart above.
<code class="docutils literal notranslate"><span class="pre">StationData</span></code> may be useful for individual stations and is an extended
Python dictionary (if you are familiar with Python).</p>
<p>You may print it to see what is in there:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">station_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Pyaerocom StationData
---------------------
instrument_name: sun_photometer
unit (&lt;class &#39;pyaerocom._lowlevel_helpers.BrowseDict&#39;&gt;)
dataset_name: AeronetSunV3Lev2.daily
station_name: Leipzig
PI: Brent_Holben
stat_lat: nan
stat_lon: nan
stat_alt: nan
ts_type_src: daily
od550aer: 2001-05-20 12:00:00    0.190538
2001-05-21 12:00:00    0.165246
2001-05-22 12:00:00    0.117999
2001-05-23 12:00:00    0.067452
2001-05-24 12:00:00    0.077793
2001-05-30 12:00:00    0.119798
2001-06-03 12:00:00    0.121039
2001-06-06 12:00:00    0.312110
2001-06-07 12:00:00    0.192976
2001-06-09 12:00:00    0.558903
2001-06-11 12:00:00    0.206287
2001-06-12 12:00:00    0.294526
2001-06-13 12:00:00    0.333145
2001-06-14 12:00:00    0.346363
2001-06-15 12:00:00    0.332472
2001-06-16 12:00:00    0.220668
2001-06-17 12:00:00    0.103815
2001-06-19 12:00:00    0.146963
2001-06-20 12:00:00    0.149631
2001-06-21 12:00:00    0.322529
2001-06-23 12:00:00    0.266764
2001-06-24 12:00:00    0.148060
2001-06-25 12:00:00    0.468637
2001-06-26 12:00:00    0.168430
2001-06-27 12:00:00    0.224706
2001-06-28 12:00:00    0.837737
2001-06-29 12:00:00    0.472877
2001-06-30 12:00:00    0.421142
2001-07-01 12:00:00    0.285850
2001-07-02 12:00:00    0.149566
                         ...
2017-09-20 12:00:00    0.098478
2017-09-21 12:00:00    0.285237
2017-09-22 12:00:00    0.296735
2017-09-23 12:00:00    0.350108
2017-09-27 12:00:00    0.336902
2017-09-28 12:00:00    0.253596
2017-09-29 12:00:00    0.172088
2017-09-30 12:00:00    0.173876
2017-10-12 12:00:00    0.076930
2017-10-14 12:00:00    0.067515
2017-10-15 12:00:00    0.039083
2017-10-16 12:00:00    0.174384
2017-10-17 12:00:00    0.087807
2017-10-18 12:00:00    0.178155
2017-10-19 12:00:00    0.116929
2017-10-22 12:00:00    0.065865
2017-10-29 12:00:00    0.124535
2017-10-30 12:00:00    0.041524
2017-11-02 12:00:00    0.143081
2017-11-03 12:00:00    0.158916
2017-11-06 12:00:00    0.110552
2017-11-17 12:00:00    0.081437
2017-11-24 12:00:00    0.055906
2017-11-26 12:00:00    0.101109
2017-11-27 12:00:00    0.073161
2017-11-29 12:00:00    0.063464
2017-11-30 12:00:00    0.135819
2017-12-01 12:00:00    0.160344
2017-12-03 12:00:00    0.109541
2017-12-07 12:00:00    0.087100
Length: 2713, dtype: float64
dtime (array, 2713 items)
   [numpy.datetime64(&#39;2001-05-20T12:00:00&#39;)
    numpy.datetime64(&#39;2001-05-21T12:00:00&#39;)
    ...
    numpy.datetime64(&#39;2017-12-03T12:00:00&#39;)
    numpy.datetime64(&#39;2017-12-07T12:00:00&#39;)]

Data coordinates
.................
latitude: 51.352500000000006
longitude: 12.435278
altitude: 125.0
</pre></div>
</div>
<p>As you can see, this station contains a time-series of the AOD at 550
nm. If you like, you can plot this time-series:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">station_data</span><span class="o">.</span><span class="n">plot_variable</span><span class="p">(</span><span class="s1">&#39;od550aer&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7fe594678c18</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_70_1.png" src="_images/tut00_get_started_70_1.png" />
</div>
</div>
<div class="section" id="colocation-of-model-and-obsdata">
<h3>Colocation of model and obsdata<a class="headerlink" href="#colocation-of-model-and-obsdata" title="Permalink to this headline">¶</a></h3>
<p>Now that we have different data objects loaded we can continue with
colocation. In the following, both the all-sky and the clear-sky data
from CAM53-Oslo will be colocated with the subset of Aeronet stations
that we just loaded.</p>
<p>The colocation will be performed for the year of 2010 and two scatter
plots will be created.</p>
<p>You have also the option to apply a certain filter when colocating using
a valid filter name. Here, we use global data and exclude mountain
sides.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_all_sky_glob</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded_2D</span><span class="p">(</span><span class="n">od550aer</span><span class="p">,</span> <span class="n">aeronet_data</span><span class="p">,</span>
                                                                <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                                <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                                                <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">col_all_sky_glob</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Old</span> <span class="n">name</span> <span class="n">of</span> <span class="n">function</span> <span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">still</span> <span class="n">works</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">288</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">colocateddata</span><span class="o">.</span><span class="n">ColocatedData</span>
</pre></div>
</div>
<p>Let’s do the same for the clear-sky data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col_clear_sky_glob</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded_2D</span><span class="p">(</span><span class="n">od550csaer</span><span class="p">,</span> <span class="n">aeronet_data</span><span class="p">,</span>
                                                                  <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                                  <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                                                  <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">col_clear_sky_glob</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Old</span> <span class="n">name</span> <span class="n">of</span> <span class="n">function</span> <span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">still</span> <span class="n">works</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">288</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">colocateddata</span><span class="o">.</span><span class="n">ColocatedData</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax1</span> <span class="o">=</span> <span class="n">col_all_sky_glob</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;All sky (2010, monthly)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;All sky (2010, monthly)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_76_1.png" src="_images/tut00_get_started_76_1.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax2</span> <span class="o">=</span> <span class="n">col_clear_sky_glob</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Clear sky (2010, monthly)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Clear sky (2010, monthly)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_77_1.png" src="_images/tut00_get_started_77_1.png" />
<p>… or for EUROPE:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded_2D</span><span class="p">(</span><span class="n">od550aer</span><span class="p">,</span> <span class="n">aeronet_data</span><span class="p">,</span>
                                             <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                             <span class="n">start</span><span class="o">=</span><span class="mi">2010</span><span class="p">,</span>
                                             <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;EUROPE-noMOUNTAINS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Old</span> <span class="n">name</span> <span class="n">of</span> <span class="n">function</span> <span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">still</span> <span class="n">works</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">288</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7fe594831f98</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut00_get_started_79_3.png" src="_images/tut00_get_started_79_3.png" />
</div>
</div>
<div class="section" id="aerocom-default-regions">
<h2>AEROCOM default regions<a class="headerlink" href="#aerocom-default-regions" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces how pya handles information related to default
regions (e.g.&nbsp;Europe, Asia, …) as used in the <a class="reference external" href="http://aerocom.met.no/cgi-bin/AEROCOM/aerocom/surfobs_annualrs.pl">AEROCOM
interface</a>.
All default regions are defined in the file
<a class="reference external" href="http://aerocom.met.no/pya/config_files.html#default-regions">regions.ini</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">region</span><span class="o">.</span><span class="n">get_all_default_region_ids</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;WORLD&#39;</span><span class="p">,</span> <span class="s1">&#39;EUROPE&#39;</span><span class="p">,</span> <span class="s1">&#39;ASIA&#39;</span><span class="p">,</span> <span class="s1">&#39;AUSTRALIA&#39;</span><span class="p">,</span> <span class="s1">&#39;CHINA&#39;</span><span class="p">,</span> <span class="s1">&#39;INDIA&#39;</span><span class="p">,</span> <span class="s1">&#39;NAFRICA&#39;</span><span class="p">,</span> <span class="s1">&#39;SAFRICA&#39;</span><span class="p">,</span> <span class="s1">&#39;SAMERICA&#39;</span><span class="p">,</span> <span class="s1">&#39;NAMERICA&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now load some default regions and print them.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">europe</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">)</span>
<span class="n">asia</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">Region</span><span class="p">(</span><span class="s2">&quot;ASIA&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">europe</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">asia</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaeorocom</span> <span class="n">Region</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">EUROPE</span>
<span class="n">Longitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
<span class="n">Longitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>

<span class="n">pyaeorocom</span> <span class="n">Region</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">ASIA</span>
<span class="n">Longitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
<span class="n">Longitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">]</span>
<span class="n">Latitude</span> <span class="nb">range</span> <span class="p">(</span><span class="n">plots</span><span class="p">):</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="load-example-data-and-apply-region-specific-crop">
<h3>Load example data and apply region specific crop<a class="headerlink" href="#load-example-data-and-apply-region-specific-crop" title="Permalink to this headline">¶</a></h3>
<p>In the following cell, we create an instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code>
class (hich is introduced in more detail in a later tutorial), load some
test data (from the CAMS ECMWF OSUITE dataset), crop it and plot a map
of the results over Europe.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">()</span>
<span class="n">data</span><span class="o">.</span><span class="n">_init_testdata_default</span><span class="p">()</span>
<span class="n">crop</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;EUROPE&quot;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">crop</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut01_intro_regions_5_1.png" src="_images/tut01_intro_regions_5_1.png" />
</div>
</div>
<div class="section" id="reading-model-data-the-readgridded-class">
<h2>Reading model data: the <em>ReadGridded</em> class<a class="headerlink" href="#reading-model-data-the-readgridded-class" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces the
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.io.readgridded.ReadGridded">ReadGridded</a>
class of pyaerocom, a flexible interface for importing model results
from a single model, based on variable name (e.g. <em>od550aer</em>,
<em>od550bc</em>), start / stop time stamps and temporal resolution (e.g.
<em>hourly, 3hourly, daily, monthly</em>).</p>
<p>The class is part of the
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#module-pyaerocom.io.readgridded">readgridded</a>
module of pyaerocom, as well as the class
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.io.readgridded.ReadGriddedMulti">ReadGriddedMulti</a>.</p>
<p>In the following cells, we create an instance of the the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code>
class and use this object to find and import data files containing the
aerosol optical depth at 550 nm (<em>od550aer</em>) from the ECMWF CAMS
reanalysis model (<em>ECMWF_CAMS_REAN</em>) for the years 2003-2007 in daily
resolution. The files will be temporally merged and put into an instance
of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class.</p>
<p>We start with creating a reading object, that will take care of finding
the model directory for us (based on the model ID) and all valid NetCDF
files on initialisation. Use the <code class="docutils literal notranslate"><span class="pre">print</span></code> commant to preview the string
representation of <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> object, which provides useful
information about what is in there.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>
<span class="n">read</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_CAMS_REAN&quot;</span><span class="p">,</span>
                          <span class="n">start</span><span class="o">=</span><span class="s2">&quot;1-1-2003&quot;</span><span class="p">,</span>
                          <span class="n">stop</span><span class="o">=</span><span class="s2">&quot;31-12-2007&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span><span class="n">ECMWF_CAMS_REAN</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The output contains information about all variables that were found and
all corresponding years. These information is extracted from the
filenames, which have to follow the AEROCOM file naming conventions.</p>
<p><strong>Please note</strong> that at this point, no data is actually imported but
only the paths are set that contain data for this model. In order to
read one variable, call the <code class="docutils literal notranslate"><span class="pre">read_var</span></code> function with a valid variable
name. You can check available variables using the <code class="docutils literal notranslate"><span class="pre">vars</span></code> attribute (or
by printing the string representation, as shown in the cell above).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Detected variables for model </span><span class="si">%s</span><span class="s2">:</span><span class="se">\n</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">read</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">read</span><span class="o">.</span><span class="n">vars</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Detected</span> <span class="n">variables</span> <span class="k">for</span> <span class="n">model</span> <span class="n">ECMWF_CAMS_REAN</span><span class="p">:</span>
 <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">read</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The returned data object is of type
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.griddeddata.GriddedData">GriddedData</a>
class, which will be introduced in more detail later. This data object
is returned by the <code class="docutils literal notranslate"><span class="pre">read_var</span></code> method and can also be accessed from the
instance of the reading class using:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">read</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;od550aer&quot;</span><span class="p">]</span>
<span class="n">d</span> <span class="ow">is</span> <span class="n">data</span> <span class="c1">#?</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<p>We may also import other variables using either the above used method
<code class="docutils literal notranslate"><span class="pre">read_var</span></code> or the more general <code class="docutils literal notranslate"><span class="pre">read</span></code> method which can read single
or multiple variables on the run.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">read</span><span class="o">.</span><span class="n">read</span><span class="p">([</span><span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
 <span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">1826</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span><span class="o">&gt;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s double check if all variables have been imported.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span><span class="n">ECMWF_CAMS_REAN</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">GriddedData</span> <span class="n">objects</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550bc</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550oa</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550so4</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2003</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2007</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>
</pre></div>
</div>
<p>In the following we continue with the <code class="docutils literal notranslate"><span class="pre">od550aer</span></code> data object that was
loaded first and that was assigned the name <code class="docutils literal notranslate"><span class="pre">data</span></code> above.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The data object is of type </span><span class="si">%s</span><span class="s2"> and contains </span><span class="si">%d</span><span class="s2"> time stamps&quot;</span> <span class="o">%</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>The data object is of type &lt;class &#39;pyaerocom.griddeddata.GriddedData&#39;&gt; and contains 1826 time stamps
</pre></div>
</div>
<p>The returned
<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.griddeddata.GriddedData">GriddedData</a>
object contains 1826 time stamps. Given that the defined period of 5
years includes one leap year, we should expect that we imported data for
each day of the five years?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">1826</span> <span class="o">==</span> <span class="mi">5</span><span class="o">*</span><span class="mi">365</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="section" id="remark-on-time-definition">
<h3>Remark on time definition<a class="headerlink" href="#remark-on-time-definition" title="Permalink to this headline">¶</a></h3>
<p>If you run this notebook with <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code> in the reading object,
you will receive the output</p>
<p><code class="docutils literal notranslate"><span class="pre">Error</span> <span class="pre">message:</span> <span class="pre">AttributeError('Cube</span> <span class="pre">does</span> <span class="pre">not</span> <span class="pre">contain</span> <span class="pre">time</span> <span class="pre">dimension',)</span>&#160; <span class="pre">Invalid</span> <span class="pre">time</span> <span class="pre">axis</span> <span class="pre">in</span> <span class="pre">file</span> <span class="pre">ECMWF_CAMS_REAN.daily.od550aer.2007.nc.</span> <span class="pre">Attempting</span> <span class="pre">to</span> <span class="pre">correct.</span></code></p>
<p>several times when reading the data. This warning indicates, that the
corresponding data in the netCDF files has some issue with the time
dimension. Here, the time variable is not properly defined in the NetCDF
file. Pyaerocom can correct for this on data import by</p>
<ol class="arabic simple">
<li>First checking if the time dimension in the NetCDF file is correct
according to CF convention (<a class="reference external" href="http://aerocom.met.no/pyaerocom/api.html#pyaerocom.io.helpers.check_time_coord">see here for details on the
implementation</a>
and if a problem is detected, then …</li>
<li>the time axis is redefined based on the year and time resolution
(<em>ts_type</em>) that is encrypted in the filename. The latter requires
that the file follows one of the <a class="reference external" href="http://aerocom.met.no/pyaerocom/config_files.html#file-conventions">pyaerocom file
conventions</a>.</li>
</ol>
</div>
<div class="section" id="a-very-brief-introduction-into-the-griddeddata-class">
<h3>A very brief introduction into the GriddedData class<a class="headerlink" href="#a-very-brief-introduction-into-the-griddeddata-class" title="Permalink to this headline">¶</a></h3>
<p>Now as a final step, we briefly introduce some of the features of the
<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class by computing and plotting a time series of the
global weighted average aerosol optical density as well as the same time
series at the coordinates in the city of Leipzig, Germany.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="k">import</span> <span class="n">Series</span>
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">gaussian_filter1d</span>
<span class="c1">#compute global mean (area weighted)</span>
<span class="n">glob_mean</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">area_weighted_mean</span><span class="p">()</span>

<span class="c1">#extract AODs at the position of Leipzig</span>
<span class="n">lon_leipzig</span> <span class="o">=</span> <span class="mf">12.44</span>
<span class="n">lat_leipzig</span> <span class="o">=</span> <span class="mf">51.35</span>

<span class="n">data_leipzig</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">interpolate</span><span class="p">([(</span><span class="s2">&quot;latitude&quot;</span><span class="p">,</span> <span class="n">lat_leipzig</span><span class="p">),</span>
                                 <span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">,</span> <span class="n">lon_leipzig</span><span class="p">)])</span>

<span class="c1"># create pandas Series for global average</span>
<span class="n">s_glob</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">glob_mean</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">())</span>

<span class="c1"># create pandas Series for leipzig average (and smooth in time)</span>
<span class="n">GAUSS_SIGMA</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">s_leipzig</span> <span class="o">=</span> <span class="n">Series</span><span class="p">(</span><span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">data_leipzig</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">GAUSS_SIGMA</span><span class="p">),</span>
                   <span class="n">data_leipzig</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">())</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">s_leipzig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;City of Leipzig (smoothed $\sigma$=</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="k">GAUSS_SIGMA</span>, figsize=(14,5))
<span class="n">s_glob</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Global trend&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">tit</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;AOD @ 550nm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">analysis</span><span class="o">/</span><span class="n">cartography</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">377</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Using</span> <span class="n">DEFAULT_SPHERICAL_EARTH_RADIUS</span><span class="o">.</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Using DEFAULT_SPHERICAL_EARTH_RADIUS.&quot;</span><span class="p">)</span>
<span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">1826</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<img alt="_images/tut02_intro_class_ReadGridded_17_1.png" src="_images/tut02_intro_class_ReadGridded_17_1.png" />
<p>In the following section, the <code class="docutils literal notranslate"><span class="pre">ReadGriddedMulti</span></code> class is introduced,
which is largely based on the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class and allows for
importing data from multiple models.</p>
</div>
</div>
<div class="section" id="reading-data-from-multiple-models-the-readgriddedmulti-class">
<h2>Reading data from multiple models: the ReadGriddedMulti class<a class="headerlink" href="#reading-data-from-multiple-models-the-readgriddedmulti-class" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">pyaerocom.ReadGriddedMulti</span></code> class provides an interface to import
multiple variables for an arbitrary number of gridded datasets
(e.g.&nbsp;model data, level 2 satellite data) and within a specific time
interval. It makes large use of the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class that provides
an interface for importing results from a single dataset.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Define two models (this list can contain as many models as you like)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AATSR_SU_v4.3&quot;</span><span class="p">,</span> <span class="s2">&quot;CAM5.3-Oslo_CTRL2016&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Again, if you are not sure what is the exact name of the dataset you are
searching for, you may use wildcards to search for options. For
instance, if you want to include results from the implementation of the
sectional aerosol microphysics module (SALSA) in the ECHAM5-HAM
aerosol-climate model, you may search if data exists …</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">pya</span><span class="o">.</span><span class="n">search_data_dir_aerocom</span><span class="p">(</span><span class="s2">&quot;*ECHAM*salsa*CTRL*2015&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
<p>… and include it:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;ECHAM6-SALSA_AP3-CTRL2015&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now create and initiate <code class="docutils literal notranslate"><span class="pre">ReadGriddedMulti</span></code> class. The directory for
each model as well as all valid files in the model directories are
searched on initiation of the instance. Valid here means, that the files
belong to the corresponding model. Subsetting of the time interval is
done in a later process.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">read</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGriddedMulti</span><span class="p">(</span><span class="n">models</span><span class="p">,</span> <span class="s1">&#39;2010&#39;</span><span class="p">,</span><span class="s1">&#39;2011&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGriddedMulti</span>
<span class="o">--------------------------</span>
<span class="n">Model</span> <span class="n">IDs</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AATSR_SU_v4.3&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5.3-Oslo_CTRL2016&#39;</span><span class="p">,</span> <span class="s1">&#39;ECHAM6-SALSA_AP3-CTRL2015&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">data</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">CCI</span><span class="o">-</span><span class="n">Aerosol</span><span class="o">/</span><span class="n">CCI_AEROSOL_Phase2</span><span class="o">/</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550erraer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550gt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">]</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;deltaz3d&#39;</span><span class="p">,</span> <span class="s1">&#39;humidity3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;3hourly&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">]</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;depbc&#39;</span><span class="p">,</span> <span class="s1">&#39;depdust&#39;</span><span class="p">,</span> <span class="s1">&#39;depoa&#39;</span><span class="p">,</span> <span class="s1">&#39;depso4&#39;</span><span class="p">,</span> <span class="s1">&#39;depss&#39;</span><span class="p">,</span> <span class="s1">&#39;emibc&#39;</span><span class="p">,</span> <span class="s1">&#39;emidms&#39;</span><span class="p">,</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span> <span class="s1">&#39;emiss&#39;</span><span class="p">,</span> <span class="s1">&#39;emivoc&#39;</span><span class="p">,</span> <span class="s1">&#39;emivoct&#39;</span><span class="p">,</span> <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span> <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span> <span class="s1">&#39;loadss&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>As you can see, the 3 different instances of the <code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class
were created (which was introduced in the previous tutorial), one for
each of the 3 requested datasets. These can be used to access the data
for each of the datasets.</p>
<p>Let’s define a bunch of test variables that are supposed to be loaded
for each model.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="s2">&quot;od550dust&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Read all variables for all models</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_dict</span> <span class="o">=</span> <span class="n">read</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">test_vars</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s2">&quot;daily&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>As we can see, for the ECHAM6 data, the import failed. The reason for
this is, that these data only exists in monthly resolution. We can load
this data manually.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">read</span><span class="p">[</span><span class="s2">&quot;ECHAM6-SALSA_AP3-CTRL2015&quot;</span><span class="p">]</span>
<span class="n">r</span><span class="o">.</span><span class="n">vars</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;depbc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depdust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depoa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depso4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;depss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emibc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emidms&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emidust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emiss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emivoc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;emivoct&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;loadss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;sconcss&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Now read the aerosol optical depth at 550 nm and in monthly resolution.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s2">&quot;monthly&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_ambient_aerosol_particles</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">96</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Print what is in there (similar to the previously introduced
<code class="docutils literal notranslate"><span class="pre">ReadGridded</span></code> class, also the <code class="docutils literal notranslate"><span class="pre">ReadGriddedMulti</span></code> class has a helpful
string representation)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">read</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGriddedMulti</span>
<span class="o">--------------------------</span>
<span class="n">Model</span> <span class="n">IDs</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AATSR_SU_v4.3&#39;</span><span class="p">,</span> <span class="s1">&#39;CAM5.3-Oslo_CTRL2016&#39;</span><span class="p">,</span> <span class="s1">&#39;ECHAM6-SALSA_AP3-CTRL2015&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">data</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">CCI</span><span class="o">-</span><span class="n">Aerosol</span><span class="o">/</span><span class="n">CCI_AEROSOL_Phase2</span><span class="o">/</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550erraer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550gt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">GriddedData</span> <span class="n">objects</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;abs550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;deltaz3d&#39;</span><span class="p">,</span> <span class="s1">&#39;humidity3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer3d&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aerh2o&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dryaer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550lt1aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od870aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;3hourly&#39;</span><span class="p">,</span> <span class="s1">&#39;daily&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">GriddedData</span> <span class="n">objects</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">daily</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">AEROCOM</span><span class="o">-</span><span class="n">PHASE</span><span class="o">-</span><span class="n">III</span><span class="o">/</span><span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;depbc&#39;</span><span class="p">,</span> <span class="s1">&#39;depdust&#39;</span><span class="p">,</span> <span class="s1">&#39;depoa&#39;</span><span class="p">,</span> <span class="s1">&#39;depso4&#39;</span><span class="p">,</span> <span class="s1">&#39;depss&#39;</span><span class="p">,</span> <span class="s1">&#39;emibc&#39;</span><span class="p">,</span> <span class="s1">&#39;emidms&#39;</span><span class="p">,</span> <span class="s1">&#39;emidust&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso2&#39;</span><span class="p">,</span> <span class="s1">&#39;emiso4&#39;</span><span class="p">,</span> <span class="s1">&#39;emiss&#39;</span><span class="p">,</span> <span class="s1">&#39;emivoc&#39;</span><span class="p">,</span> <span class="s1">&#39;emivoct&#39;</span><span class="p">,</span> <span class="s1">&#39;loadbc&#39;</span><span class="p">,</span> <span class="s1">&#39;loaddust&#39;</span><span class="p">,</span> <span class="s1">&#39;loadoa&#39;</span><span class="p">,</span> <span class="s1">&#39;loadso4&#39;</span><span class="p">,</span> <span class="s1">&#39;loadss&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcbc&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcdust&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcoa&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcso4&#39;</span><span class="p">,</span> <span class="s1">&#39;sconcss&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2010</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;monthly&#39;</span><span class="p">]</span>

<span class="n">Loaded</span> <span class="n">GriddedData</span> <span class="n">objects</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">monthly</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Pyaerocom</span> <span class="n">GriddedData</span>
<span class="o">---------------------</span>
<span class="n">Variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">Temporal</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">monthly</span>
<span class="n">Start</span> <span class="o">/</span> <span class="n">Stop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>
</pre></div>
</div>
<p>Print some information about the different data objects</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">read</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current model: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">name</span>)
    <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Current variable: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">var_name</span>)
        <span class="c1"># data is of type pya.GriddedData which uses an extended representation of the Cube class</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Current</span> <span class="n">model</span><span class="p">:</span> <span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_ambient_aerosol</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">366</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">180</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">360</span><span class="p">)</span><span class="o">&gt;</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_ambient_aerosol</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">366</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">180</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">360</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">Current</span> <span class="n">model</span><span class="p">:</span> <span class="n">CAM5</span><span class="o">.</span><span class="mi">3</span><span class="o">-</span><span class="n">Oslo_CTRL2016</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">288</span><span class="p">)</span><span class="o">&gt;</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">mineral</span> <span class="n">aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">288</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">Current</span> <span class="n">model</span><span class="p">:</span> <span class="n">ECHAM6</span><span class="o">-</span><span class="n">SALSA_AP3</span><span class="o">-</span><span class="n">CTRL2015</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550aer</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_ambient_aerosol_particles</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">96</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">)</span><span class="o">&gt;</span>

<span class="n">Current</span> <span class="n">variable</span><span class="p">:</span> <span class="n">od550dust</span>
<span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">iris</span> <span class="s1">&#39;Cube&#39;</span> <span class="n">of</span> <span class="n">atmosphere_optical_thickness_due_to_dust_ambient_aerosol_particles</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">12</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">96</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">192</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Now get and arbitrarily crop the CAM5.3-Oslo_CTRL2016 data object
containing the od550aer values and draw a map.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">read</span><span class="p">[</span><span class="s2">&quot;CAM5.3-Oslo_CTRL2016&quot;</span><span class="p">][</span><span class="s2">&quot;od550aer&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Start / stop before crop: </span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
      <span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">start</span><span class="p">,</span>
        <span class="n">data</span><span class="o">.</span><span class="n">stop</span><span class="p">))</span>

<span class="n">dat_crop</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">lon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
                     <span class="n">lat_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">45</span><span class="p">),</span>
                     <span class="n">time_range</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;15 March 2010&#39;</span><span class="p">,</span><span class="s1">&#39;22 June 2010&#39;</span><span class="p">))</span>


<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Start / stop after crop: </span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2">&quot;</span>
      <span class="o">%</span><span class="p">(</span><span class="n">dat_crop</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">point</span><span class="p">,</span>
        <span class="n">dat_crop</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">point</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Start</span> <span class="o">/</span> <span class="n">stop</span> <span class="n">before</span> <span class="n">crop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">31</span><span class="n">T23</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mf">59.999999</span>

<span class="n">Start</span> <span class="o">/</span> <span class="n">stop</span> <span class="n">after</span> <span class="n">crop</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">15</span> <span class="mi">10</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span> <span class="o">-</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">22</span> <span class="mi">10</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">00</span>
</pre></div>
</div>
<p>Plot a map of the first day.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">dat_crop</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/tut03_intro_class_ReadGriddedMulti_25_0.png" src="_images/tut03_intro_class_ReadGriddedMulti_25_0.png" />
<div class="section" id="iterate-over-models-and-variables">
<h3>Iterate over models and variables<a class="headerlink" href="#iterate-over-models-and-variables" title="Permalink to this headline">¶</a></h3>
<p>The following cell iterates over all imported variables and models and
plots the first time stamp of each result file.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">read</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">model_data</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">model_data</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_0.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_0.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_1.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_1.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_2.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_2.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_3.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_3.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_4.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_4.png" />
<img alt="_images/tut03_intro_class_ReadGriddedMulti_27_5.png" src="_images/tut03_intro_class_ReadGriddedMulti_27_5.png" />
</div>
</div>
<div class="section" id="introducing-the-griddeddata-class">
<h2>Introducing the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class<a class="headerlink" href="#introducing-the-griddeddata-class" title="Permalink to this headline">¶</a></h2>
<p>This notebook introduces basic features of the
<a class="reference external" href="http://aerocom.met.no/pya/api.html#pya.griddeddata.GriddedData">GriddedData</a>
class of pya. The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is the fundamental base class
for the analysis of model data. The underlying data type is
<a class="reference external" href="http://scitools.org.uk/iris/docs/latest/iris/iris/cube.html#iris.cube.Cube">iris.cube.Cube</a>
which was extended, for instance by allowing direct imports of netCDF
files when creating an instance of <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> (i.e.&nbsp;by passing the
filename and specifying the variable name on initialisation). This
notebook introduces some of the features of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class.
Starting with some imports…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
</pre></div>
</div>
<p>Let’s get a test file to load</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_files</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">testfiles</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">filepath</span> <span class="ow">in</span> <span class="n">test_files</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">filepath</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aatsr_su_v4</span><span class="o">.</span><span class="mi">3</span>
<span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">CCI</span><span class="o">-</span><span class="n">Aerosol</span><span class="o">/</span><span class="n">CCI_AEROSOL_Phase2</span><span class="o">/</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">AATSR_SU_v4</span><span class="o">.</span><span class="mf">3.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2008.</span><span class="n">nc</span>

<span class="n">ecmwf_osuite</span>
<span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">/</span><span class="n">renamed</span><span class="o">/</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT_test</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550aer</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span>
</pre></div>
</div>
<p>The dictionary, returned by the <code class="docutils literal notranslate"><span class="pre">get()</span></code> function is categorised into
two subirectories for model based test files (<code class="docutils literal notranslate"><span class="pre">key=&quot;models&quot;</span></code>) and for
observation based test files (<code class="docutils literal notranslate"><span class="pre">key=observations</span></code>). So far, there is
not much in there (i.e.&nbsp;only two files).</p>
<p>Let’s pick out the ECMWF OSUITE test file and load the data directly
into an instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class. The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class
takes either preloaded instances of the <code class="docutils literal notranslate"><span class="pre">iris.cube.Cube</span></code> class as
input, or a valid netCDF file path. The latter requires specification of
the variable name which is then filtered from the data stored in the
netCDF file (which may contain multiple variables. The following example
imports the data for the aerosol optical density at 550 nm. The string
representation of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class (see print at end of
following code cell) was slitghtly adapted from the underlying <code class="docutils literal notranslate"><span class="pre">Cube</span></code>
object.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fpath</span> <span class="o">=</span> <span class="n">test_files</span><span class="p">[</span><span class="s2">&quot;models&quot;</span><span class="p">][</span><span class="s2">&quot;ecmwf_osuite&quot;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">:</span> <span class="n">ECMWF_OSUITE</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="n">Dust</span> <span class="n">Aerosol</span> <span class="n">Optical</span> <span class="n">Depth</span> <span class="n">at</span> <span class="mi">550</span><span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="n">unknown</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">451</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">900</span><span class="p">)</span>
     <span class="n">Dimension</span> <span class="n">coordinates</span><span class="p">:</span>
          <span class="n">time</span>                                       <span class="n">x</span>              <span class="o">-</span>               <span class="o">-</span>
          <span class="n">latitude</span>                                   <span class="o">-</span>              <span class="n">x</span>               <span class="o">-</span>
          <span class="n">longitude</span>                                  <span class="o">-</span>              <span class="o">-</span>               <span class="n">x</span>
     <span class="n">Attributes</span><span class="p">:</span>
          <span class="n">Conventions</span><span class="p">:</span> <span class="n">CF</span><span class="o">-</span><span class="mf">1.0</span>
          <span class="n">NCO</span><span class="p">:</span> <span class="mf">4.7</span><span class="o">.</span><span class="mi">2</span>
          <span class="n">history</span><span class="p">:</span> <span class="n">Tue</span> <span class="n">Mar</span> <span class="mi">20</span> <span class="mi">13</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">49</span> <span class="mi">2018</span><span class="p">:</span> <span class="n">ncks</span> <span class="o">-</span><span class="mi">7</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">o</span> <span class="n">test</span><span class="o">.</span><span class="n">nc</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">v</span> <span class="n">time_bnds</span> <span class="n">od550aer</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">orig</span><span class="o">.</span><span class="n">nc</span>
<span class="n">Tue</span><span class="o">...</span>
          <span class="n">history_of_appended_files</span><span class="p">:</span> <span class="n">Tue</span> <span class="n">Mar</span> <span class="mi">20</span> <span class="mi">02</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">15</span> <span class="mi">2018</span><span class="p">:</span> <span class="n">Appended</span> <span class="n">file</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom1</span><span class="o">/</span><span class="n">ECMWF_OSUITE_NRT</span><span class="o">/</span><span class="n">renamed</span><span class="o">//</span><span class="n">aerocom</span><span class="o">.</span><span class="n">ECMWF_OSUITE_NRT</span><span class="o">.</span><span class="n">daily</span><span class="o">.</span><span class="n">od550bc</span><span class="o">.</span><span class="mf">2018.</span><span class="n">nc</span><span class="o">...</span>
          <span class="n">invalid_units</span><span class="p">:</span> <span class="o">~</span>
          <span class="n">nco_openmp_thread_number</span><span class="p">:</span> <span class="mi">1</span>
     <span class="n">Cell</span> <span class="n">methods</span><span class="p">:</span>
          <span class="n">mean</span><span class="p">:</span> <span class="n">time</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="remark-on-longitude-definition">
<h3>Remark on longitude definition<a class="headerlink" href="#remark-on-longitude-definition" title="Permalink to this headline">¶</a></h3>
<div class="alert alert-block alert-info"><p>If the longitudes in the original NetCDF file are defined as</p>
<div class="math notranslate nohighlight">
\[0 \leq\,\text{lon}\,\leq360\]</div>
<p>they are converted automatically to</p>
<div class="math notranslate nohighlight">
\[-180\leq\,\text{lon}\,\leq180\]</div>
<p>when an instance of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is created (see print
statment above <em>Rolling longitudes to -180 -&gt; 180 definition</em>). This is,
for instance, the case for the ECMWF OSUITE data files.</p>
</div></div>
<div class="section" id="features-of-the-griddeddata-class">
<h3>Features of the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class<a class="headerlink" href="#features-of-the-griddeddata-class" title="Permalink to this headline">¶</a></h3>
<p>In the following cell, some of the most important attributes are
introduced. These are mostly reimplementations of the underlying
<code class="docutils literal notranslate"><span class="pre">Cube</span></code> data which is stored in the <code class="docutils literal notranslate"><span class="pre">GriddedData.grid</span></code> attribute. For
instance the attribute <code class="docutils literal notranslate"><span class="pre">GriddedData.longitude</span></code> get’s you
<code class="docutils literal notranslate"><span class="pre">GriddedData.grid.coord(&quot;longitude&quot;)</span></code>, <code class="docutils literal notranslate"><span class="pre">GriddedData.latitude</span></code> get’s
you <code class="docutils literal notranslate"><span class="pre">GriddedData.grid.coord(&quot;latitude&quot;)</span></code> and <code class="docutils literal notranslate"><span class="pre">GriddedData.time</span></code>
get’s you <code class="docutils literal notranslate"><span class="pre">GriddedData.grid.coord(&quot;time&quot;)</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">var_name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Longitude attr is pointer to DimCoord instance of underlying Cube: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span> <span class="ow">is</span> <span class="n">data</span><span class="o">.</span><span class="n">grid</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;longitude&quot;</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">tstamps</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">time_stamps</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tstamps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tstamps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>od550aer
&lt;class &#39;iris.coords.DimCoord&#39;&gt;
Longitude attr is pointer to DimCoord instance of underlying Cube: True
-180.0 179.60000610351562
-90.0 90.0
0.0 364.0
2018-01-01T00:00:00.000000 2018-12-31T00:00:00.000000
</pre></div>
</div>
<p>If you do not specify the variable type, an Exception is raised, that
will get you some information about what variables are available in the
file (if the file is readable using the <code class="docutils literal notranslate"><span class="pre">iris.load</span></code> method).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">fpath</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pya</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">NetcdfError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This did not work...error message: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">repr</span>(e))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">work</span><span class="o">...</span><span class="n">error</span> <span class="n">message</span><span class="p">:</span> <span class="n">NetcdfError</span><span class="p">(</span><span class="s2">&quot;Could not load single cube from /lustre/storeA/project/aerocom/aerocom1/ECMWF_OSUITE_NRT_test/renamed/aerocom.ECMWF_OSUITE_NRT_test.daily.od550aer.2018.nc. Please specify var_name. Input file contains the following variables: [&#39;od550oa&#39;, &#39;od550aer&#39;, &#39;od550so4&#39;, &#39;od550bc&#39;, &#39;od550dust&#39;]&quot;</span><span class="p">,)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, if you parse an invalid variable name, you will get some hint.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;Blaaa&quot;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This also did not work...error message: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="k">repr</span>(e))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">also</span> <span class="n">did</span> <span class="ow">not</span> <span class="n">work</span><span class="o">...</span><span class="n">error</span> <span class="n">message</span><span class="p">:</span> <span class="n">NetcdfError</span><span class="p">(</span><span class="s1">&#39;Variable Blaaa not available in file /lustre/storeA/project/aerocom/aerocom1/ECMWF_OSUITE_NRT_test/renamed/aerocom.ECMWF_OSUITE_NRT_test.daily.od550aer.2018.nc&#39;</span><span class="p">,)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>You can have a quick look at the data using the class-own quickplot
method</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">time_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">fix_aspect</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                         <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                         <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">c_over</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut04_intro_class_GriddedData_14_0.png" src="_images/tut04_intro_class_GriddedData_14_0.png" />
<p>Why not load some of the other variables…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_bc</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550bc&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
<span class="n">data_so4</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550so4&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>… and plot them as well</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig1</span> <span class="o">=</span> <span class="n">data_bc</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">()</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">data_so4</span><span class="o">.</span><span class="n">crop</span><span class="p">(</span><span class="n">lon_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
                     <span class="n">lat_range</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">60</span><span class="p">))</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">fix_aspect</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                                                       <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
                                                       <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">70</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/tut04_intro_class_GriddedData_18_0.png" src="_images/tut04_intro_class_GriddedData_18_0.png" />
<img alt="_images/tut04_intro_class_GriddedData_18_1.png" src="_images/tut04_intro_class_GriddedData_18_1.png" />
</div>
<div class="section" id="more-to-come">
<h3>… more to come<a class="headerlink" href="#more-to-come" title="Permalink to this headline">¶</a></h3>
<p>This tutorial is not yet completed as the <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is
currently under development.</p>
</div>
</div>
<div class="section" id="colocating-gridded-data-with-discrete-observations">
<h2>Colocating gridded data with discrete observations<a class="headerlink" href="#colocating-gridded-data-with-discrete-observations" title="Permalink to this headline">¶</a></h2>
<p>This notebook gives an introduction into collocation of gridded data
with observations. Here, the 550 nm AODs of the ECMWF CAMS reanalysis
model are compared with global daily AeroNet Sun V2 (Level 2) data for
the year 2010. The collocated data will be analysed and visualised in
monthly resolution. The analysis results will be plotted in the form of
the well known Aerocom loglog scatter plots as can be found in the
online interface (see e.g.
<a class="reference external" href="http://aerocom.met.no/cgi-bin/aerocom/surfobs_annualrs.pl">here</a>).</p>
<div class="section" id="note">
<h3>NOTE<a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>This notebook is currently under development</div></blockquote>
</div>
<div class="section" id="import-setup-and-imports">
<h3>Import setup and imports<a class="headerlink" href="#import-setup-and-imports" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">pya</span><span class="o">.</span><span class="n">change_verbosity</span><span class="p">(</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>

<span class="n">YEAR</span> <span class="o">=</span> <span class="mi">2010</span>
<span class="n">VAR</span> <span class="o">=</span> <span class="s2">&quot;od550aer&quot;</span>
<span class="n">TS_TYPE</span> <span class="o">=</span> <span class="s2">&quot;daily&quot;</span>
<span class="n">MODEL_ID</span> <span class="o">=</span> <span class="s2">&quot;ECMWF_CAMS_REAN&quot;</span>
<span class="n">OBS_ID</span> <span class="o">=</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="import-of-model-data">
<h3>Import of model data<a class="headerlink" href="#import-of-model-data" title="Permalink to this headline">¶</a></h3>
<p>Create reader instance for model data and print overview of what is in
there.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadGridded</span><span class="p">(</span><span class="n">MODEL_ID</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_reader</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">ReadGridded</span>
<span class="o">---------------------</span>
<span class="n">Model</span> <span class="n">ID</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Data</span> <span class="n">directory</span><span class="p">:</span> <span class="o">/</span><span class="n">lustre</span><span class="o">/</span><span class="n">storeA</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">aerocom</span><span class="o">/</span><span class="n">aerocom</span><span class="o">-</span><span class="n">users</span><span class="o">-</span><span class="n">database</span><span class="o">/</span><span class="n">ECMWF</span><span class="o">/</span><span class="n">ECMWF_CAMS_REAN</span><span class="o">/</span><span class="n">renamed</span>
<span class="n">Available</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;ang4487aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od440aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550bc&#39;</span><span class="p">,</span> <span class="s1">&#39;od550dust&#39;</span><span class="p">,</span> <span class="s1">&#39;od550oa&#39;</span><span class="p">,</span> <span class="s1">&#39;od550so4&#39;</span><span class="p">,</span> <span class="s1">&#39;od550ss&#39;</span><span class="p">,</span> <span class="s1">&#39;od865aer&#39;</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">years</span><span class="p">:</span> <span class="p">[</span><span class="mi">2003</span><span class="p">,</span> <span class="mi">2004</span><span class="p">,</span> <span class="mi">2005</span><span class="p">,</span> <span class="mi">2006</span><span class="p">,</span> <span class="mi">2007</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2009</span><span class="p">,</span> <span class="mi">2010</span><span class="p">,</span> <span class="mi">2011</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2015</span><span class="p">,</span> <span class="mi">2016</span><span class="p">,</span> <span class="mi">9999</span><span class="p">]</span>
<span class="n">Available</span> <span class="n">time</span> <span class="n">resolutions</span> <span class="p">[</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span> <span class="s1">&#39;monthly&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Since we are only interested in a single year we can use the method</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_data</span> <span class="o">=</span> <span class="n">model_reader</span><span class="o">.</span><span class="n">read_var</span><span class="p">(</span><span class="n">VAR</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">YEAR</span><span class="p">)</span>
<span class="c1">#model_data = read_result[VAR][YEAR]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">:</span> <span class="n">ECMWF_CAMS_REAN</span>
<span class="n">Grid</span> <span class="n">data</span><span class="p">:</span> <span class="n">Aerosol</span> <span class="n">optical</span> <span class="n">depth</span> <span class="n">at</span> <span class="mi">550</span> <span class="n">nm</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">;</span> <span class="n">latitude</span><span class="p">:</span> <span class="mi">161</span><span class="p">;</span> <span class="n">longitude</span><span class="p">:</span> <span class="mi">320</span><span class="p">)</span>
     <span class="n">Dimension</span> <span class="n">coordinates</span><span class="p">:</span>
          <span class="n">time</span>                             <span class="n">x</span>              <span class="o">-</span>               <span class="o">-</span>
          <span class="n">latitude</span>                         <span class="o">-</span>              <span class="n">x</span>               <span class="o">-</span>
          <span class="n">longitude</span>                        <span class="o">-</span>              <span class="o">-</span>               <span class="n">x</span>
     <span class="n">Attributes</span><span class="p">:</span>
          <span class="n">Conventions</span><span class="p">:</span> <span class="n">CF</span><span class="o">-</span><span class="mf">1.6</span>
          <span class="n">NCO</span><span class="p">:</span> <span class="s2">&quot;4.5.4&quot;</span>
          <span class="n">history</span><span class="p">:</span> <span class="n">Sat</span> <span class="n">May</span> <span class="mi">26</span> <span class="mi">21</span><span class="p">:</span><span class="mi">08</span><span class="p">:</span><span class="mi">48</span> <span class="mi">2018</span><span class="p">:</span> <span class="n">ncecat</span> <span class="o">-</span><span class="n">O</span> <span class="o">-</span><span class="n">u</span> <span class="n">time</span> <span class="o">-</span><span class="n">n</span> <span class="mi">365</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span> <span class="n">CAMS_REAN_001</span><span class="o">.</span><span class="n">nc</span><span class="o">...</span>
          <span class="n">nco_openmp_thread_number</span><span class="p">:</span> <span class="mi">1</span>
     <span class="n">Cell</span> <span class="n">methods</span><span class="p">:</span>
          <span class="n">mean</span><span class="p">:</span> <span class="n">step</span>
          <span class="n">mean</span><span class="p">:</span> <span class="n">time</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">model_data</span><span class="o">.</span><span class="n">quickplot_map</span><span class="p">(</span><span class="n">time_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tut06_colocation_7_0.png" src="_images/tut06_colocation_7_0.png" />
</div>
<div class="section" id="import-of-aeronet-sun-v3-data-level-2">
<h3>Import of AeroNet Sun V3 data (Level 2)<a class="headerlink" href="#import-of-aeronet-sun-v3-data-level-2" title="Permalink to this headline">¶</a></h3>
<p>Import Aeronet data and apply filter that selects only stations that are
located at altitudes between 0 and 1000 m.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obs_reader</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ReadUngridded</span><span class="p">(</span><span class="n">OBS_ID</span><span class="p">,</span> <span class="n">vars_to_retrieve</span><span class="o">=</span><span class="n">VAR</span><span class="p">)</span>
<span class="n">obs_data</span> <span class="o">=</span> <span class="n">obs_reader</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">filter_by_meta</span><span class="p">(</span><span class="n">stat_alt</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">UngriddedData</span>
<span class="o">-----------------------</span>
<span class="n">Contains</span> <span class="n">networks</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
<span class="n">Contains</span> <span class="n">instruments</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;sun_photometer&#39;</span><span class="p">]</span>
<span class="n">Total</span> <span class="n">no</span><span class="o">.</span> <span class="n">of</span> <span class="n">stations</span><span class="p">:</span> <span class="mi">985</span>
<span class="n">Filters</span> <span class="n">that</span> <span class="n">were</span> <span class="n">applied</span><span class="p">:</span>
 <span class="n">Filter</span> <span class="n">time</span> <span class="n">log</span><span class="p">:</span> <span class="mi">20181015180836</span>
    <span class="n">stat_alt</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="now-perform-collocation-and-plot-corresponding-scatter-plots-with-statistical-values">
<h3>Now perform collocation and plot corresponding scatter plots with statistical values<a class="headerlink" href="#now-perform-collocation-and-plot-corresponding-scatter-plots-with-statistical-values" title="Permalink to this headline">¶</a></h3>
<div class="section" id="monthly-world-no-mountains">
<h4>2010 monthly World no mountains<a class="headerlink" href="#monthly-world-no-mountains" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded_2D</span><span class="p">(</span><span class="n">model_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;monthly&#39;</span><span class="p">,</span>
                                                          <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;WORLD-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="n">data_coloc</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Old</span> <span class="n">name</span> <span class="n">of</span> <span class="n">function</span> <span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">still</span> <span class="n">works</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;od550aer&#39;</span> <span class="p">(</span><span class="n">data_source</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="mi">278</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span>     <span class="n">nan</span><span class="p">,</span> <span class="mf">0.117588</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span> <span class="mf">0.132128</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mf">0.132236</span><span class="p">,</span> <span class="mf">0.195057</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span> <span class="mf">0.098409</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mf">0.189948</span><span class="p">,</span> <span class="mf">0.140062</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.079353</span><span class="p">,</span> <span class="mf">0.204337</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.150408</span><span class="p">,</span> <span class="mf">0.190089</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.10622</span> <span class="p">,</span> <span class="mf">0.257806</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mf">0.159844</span><span class="p">,</span> <span class="mf">0.178564</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.054091</span><span class="p">,</span> <span class="mf">0.239393</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.147172</span><span class="p">,</span> <span class="mf">0.138039</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.077916</span><span class="p">,</span> <span class="mf">0.19986</span> <span class="p">]]])</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">data_source</span>   <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U22</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span>
    <span class="n">var_name</span>      <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U8</span> <span class="s1">&#39;od550aer&#39;</span> <span class="s1">&#39;od550aer&#39;</span>
  <span class="o">*</span> <span class="n">time</span>          <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">01</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">station_name</span>  <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U19</span> <span class="s1">&#39;ARM_Darwin&#39;</span> <span class="s1">&#39;ATHENS-NOA&#39;</span> <span class="s1">&#39;Agoufou&#39;</span> <span class="o">...</span>
    <span class="n">latitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="o">-</span><span class="mf">12.43</span> <span class="mf">37.97</span> <span class="mf">15.35</span> <span class="o">-</span><span class="mf">9.871</span> <span class="mf">42.02</span> <span class="o">...</span>
    <span class="n">longitude</span>     <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">130.9</span> <span class="mf">23.72</span> <span class="o">-</span><span class="mf">1.479</span> <span class="o">-</span><span class="mf">56.1</span> <span class="o">-</span><span class="mf">93.77</span> <span class="o">...</span>
    <span class="n">altitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">29.9</span> <span class="mf">130.0</span> <span class="mf">305.0</span> <span class="mf">277.0</span> <span class="mf">338.0</span> <span class="mf">49.0</span> <span class="o">...</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">data_source</span><span class="p">:</span>      <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">,</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span><span class="p">]</span>
    <span class="n">var_name</span><span class="p">:</span>         <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
    <span class="n">ts_type</span><span class="p">:</span>          <span class="n">monthly</span>
    <span class="n">filter_name</span><span class="p">:</span>      <span class="n">WORLD</span><span class="o">-</span><span class="n">noMOUNTAINS</span>
    <span class="n">ts_type_src</span><span class="p">:</span>      <span class="n">daily</span>
    <span class="n">ts_type_src_ref</span><span class="p">:</span>  <span class="n">daily</span>
    <span class="n">start_str</span><span class="p">:</span>        <span class="mi">20100101</span>
    <span class="n">stop_str</span><span class="p">:</span>         <span class="mi">20101231</span>
    <span class="n">unit</span><span class="p">:</span>             <span class="mi">1</span>
    <span class="n">data_level</span><span class="p">:</span>       <span class="n">colocated</span>
    <span class="n">revision_ref</span><span class="p">:</span>     <span class="mi">20180820</span>
    <span class="n">region</span><span class="p">:</span>           <span class="n">WORLD</span>
    <span class="n">lon_range</span><span class="p">:</span>        <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">]</span>
    <span class="n">lat_range</span><span class="p">:</span>        <span class="p">[</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
    <span class="n">alt_range</span><span class="p">:</span>        <span class="p">[</span><span class="o">-</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f495056a470</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut06_colocation_13_1.png" src="_images/tut06_colocation_13_1.png" />
</div>
<div class="section" id="daily-europe-no-mountains">
<h4>2010 daily Europe no mountains<a class="headerlink" href="#daily-europe-no-mountains" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">colocation</span><span class="o">.</span><span class="n">colocate_gridded_ungridded_2D</span><span class="p">(</span><span class="n">model_data</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">,</span> <span class="n">ts_type</span><span class="o">=</span><span class="s1">&#39;daily&#39;</span><span class="p">,</span>
                                                             <span class="n">filter_name</span><span class="o">=</span><span class="s1">&#39;EUROPE-noMOUNTAINS&#39;</span><span class="p">)</span>
<span class="n">data_coloc</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Old</span> <span class="n">name</span> <span class="n">of</span> <span class="n">function</span> <span class="n">colocate_gridded_ungridded</span><span class="p">(</span><span class="n">still</span> <span class="n">works</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interpolating</span> <span class="n">data</span> <span class="n">of</span> <span class="n">shape</span> <span class="p">(</span><span class="mi">365</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">320</span><span class="p">)</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">take</span> <span class="n">a</span> <span class="k">while</span><span class="o">.</span>
<span class="n">Successfully</span> <span class="n">interpolated</span> <span class="n">cube</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span> <span class="s1">&#39;od550aer&#39;</span> <span class="p">(</span><span class="n">data_source</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="mi">365</span><span class="p">,</span> <span class="n">station_name</span><span class="p">:</span> <span class="mi">89</span><span class="p">)</span><span class="o">&gt;</span>
<span class="n">array</span><span class="p">([[[</span><span class="mf">0.163447</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.078648</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">],</span>
        <span class="p">[</span>     <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>      <span class="n">nan</span><span class="p">,</span>      <span class="n">nan</span><span class="p">]],</span>

       <span class="p">[[</span><span class="mf">0.086522</span><span class="p">,</span> <span class="mf">0.015151</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.075447</span><span class="p">,</span> <span class="mf">0.03005</span> <span class="p">],</span>
        <span class="p">[</span><span class="mf">0.067198</span><span class="p">,</span> <span class="mf">0.043074</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.103671</span><span class="p">,</span> <span class="mf">0.042999</span><span class="p">],</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="p">[</span><span class="mf">0.242585</span><span class="p">,</span> <span class="mf">0.186407</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.053797</span><span class="p">,</span> <span class="mf">0.011344</span><span class="p">],</span>
        <span class="p">[</span><span class="mf">0.079498</span><span class="p">,</span> <span class="mf">0.122098</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.027066</span><span class="p">,</span> <span class="mf">0.019639</span><span class="p">]]])</span>
<span class="n">Coordinates</span><span class="p">:</span>
  <span class="o">*</span> <span class="n">data_source</span>   <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U22</span> <span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span>
    <span class="n">var_name</span>      <span class="p">(</span><span class="n">data_source</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U8</span> <span class="s1">&#39;od550aer&#39;</span> <span class="s1">&#39;od550aer&#39;</span>
  <span class="o">*</span> <span class="n">time</span>          <span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="n">datetime64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">02</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">03</span> <span class="o">...</span>
  <span class="o">*</span> <span class="n">station_name</span>  <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">U19</span> <span class="s1">&#39;ATHENS-NOA&#39;</span> <span class="s1">&#39;Andenes&#39;</span> <span class="s1">&#39;Arcachon&#39;</span> <span class="o">...</span>
    <span class="n">latitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">37.97</span> <span class="mf">69.28</span> <span class="mf">44.66</span> <span class="mf">45.76</span> <span class="mf">42.0</span> <span class="mf">43.93</span> <span class="o">...</span>
    <span class="n">longitude</span>     <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">23.72</span> <span class="mf">16.01</span> <span class="o">-</span><span class="mf">1.163</span> <span class="mf">3.111</span> <span class="o">-</span><span class="mf">4.603</span> <span class="o">...</span>
    <span class="n">altitude</span>      <span class="p">(</span><span class="n">station_name</span><span class="p">)</span> <span class="n">float64</span> <span class="mf">130.0</span> <span class="mf">379.0</span> <span class="mf">11.0</span> <span class="mf">423.0</span> <span class="mf">873.0</span> <span class="mf">32.0</span> <span class="o">...</span>
<span class="n">Attributes</span><span class="p">:</span>
    <span class="n">data_source</span><span class="p">:</span>      <span class="p">[</span><span class="s1">&#39;AeronetSunV3Lev2.daily&#39;</span><span class="p">,</span> <span class="s1">&#39;ECMWF_CAMS_REAN&#39;</span><span class="p">]</span>
    <span class="n">var_name</span><span class="p">:</span>         <span class="p">[</span><span class="s1">&#39;od550aer&#39;</span><span class="p">,</span> <span class="s1">&#39;od550aer&#39;</span><span class="p">]</span>
    <span class="n">ts_type</span><span class="p">:</span>          <span class="n">daily</span>
    <span class="n">filter_name</span><span class="p">:</span>      <span class="n">EUROPE</span><span class="o">-</span><span class="n">noMOUNTAINS</span>
    <span class="n">ts_type_src</span><span class="p">:</span>      <span class="n">daily</span>
    <span class="n">ts_type_src_ref</span><span class="p">:</span>  <span class="n">daily</span>
    <span class="n">start_str</span><span class="p">:</span>        <span class="mi">20100101</span>
    <span class="n">stop_str</span><span class="p">:</span>         <span class="mi">20101231</span>
    <span class="n">unit</span><span class="p">:</span>             <span class="mi">1</span>
    <span class="n">data_level</span><span class="p">:</span>       <span class="n">colocated</span>
    <span class="n">revision_ref</span><span class="p">:</span>     <span class="mi">20180820</span>
    <span class="n">region</span><span class="p">:</span>           <span class="n">EUROPE</span>
    <span class="n">lon_range</span><span class="p">:</span>        <span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">70</span><span class="p">]</span>
    <span class="n">lat_range</span><span class="p">:</span>        <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">80</span><span class="p">]</span>
    <span class="n">alt_range</span><span class="p">:</span>        <span class="p">[</span><span class="o">-</span><span class="mf">1000000.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_coloc</span><span class="o">.</span><span class="n">plot_scatter</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">_subplots</span><span class="o">.</span><span class="n">AxesSubplot</span> <span class="n">at</span> <span class="mh">0x7f495077feb8</span><span class="o">&gt;</span>
</pre></div>
</div>
<img alt="_images/tut06_colocation_16_1.png" src="_images/tut06_colocation_16_1.png" />
<div class="section" id="further-tutorials-in-depth">
<h5>Further tutorials (in-depth)<a class="headerlink" href="#further-tutorials-in-depth" title="Permalink to this headline">¶</a></h5>
</div>
</div>
</div>
</div>
<div class="section" id="handling-of-time-in-pyaerocom">
<h2>Handling of time in pyaerocom<a class="headerlink" href="#handling-of-time-in-pyaerocom" title="Permalink to this headline">¶</a></h2>
<p>The
<a class="reference external" href="http://aerocom.met.no/pya/api.html#module-pya.griddeddata">GriddedData</a>
class of <em>pyaerocom</em> was introduced in the previous tutorial.</p>
<p>Here, we illustrate how <em>pyaerocom</em> handles time. In particular, how
<em>pyaerocom</em> performs the conversion of CF conform numerical time stamps
with a defined unit (i.e.&nbsp;basedate and calendar, see e.g.
<a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.6/build/cf-conventions.html#time-coordinate">here</a>
for details) into datetime-like objects that can be interpreted by tools
such as <a class="reference external" href="https://pandas.pydata.org/">Pandas</a>.</p>
<p>The easiest way to work with time stamps in model data is, to simply
work on the internal numerical indices, avoiding the necessity to
convert them into actual datetime objects. However, sometimes (e.g.&nbsp;if
we want to extract and analyse a time-series of global average Aerosol
optical densities), we wish to use third party libraries such as Pandas,
which require the timestamps to be datetime-like objects.</p>
<p>This notebook illustrates how time is handled in the iris module,
particularly in the
<a class="reference external" href="http://scitools.org.uk/iris/docs/v1.9.0/html/iris/iris/cube.html#iris.cube.Cube">Cube</a>
class, which is the basic data representation object in the <em>pya</em>
<code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class. In particular, it emphazises some peculiarities
that can lead to complications and finally shows, how <em>pya</em> circumvents
these issues. We shall see, that this does not only reduce the risk of
conversion Errors, but even results in a quite significant performance
boost when converting from numerical CF timestamps to
<code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code> time stamps.</p>
<div class="section" id="load-and-some-example-data">
<h3>Load and some example data<a class="headerlink" href="#load-and-some-example-data" title="Permalink to this headline">¶</a></h3>
<p>Get and load test data file using the new pya interface (the underlying
datatype of <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> is <code class="docutils literal notranslate"><span class="pre">iris.cube.Cube</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">testfiles</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="n">fpath_ecmwf</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">][</span><span class="s1">&#39;ecmwf_osuite&#39;</span><span class="p">]</span>
<span class="n">fpath_aatsr</span> <span class="o">=</span> <span class="n">files</span><span class="p">[</span><span class="s1">&#39;models&#39;</span><span class="p">][</span><span class="s1">&#39;aatsr_su_v4.3&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_ecmwf</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath_ecmwf</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;ECMWF_OSUITE&quot;</span><span class="p">)</span>
<span class="n">data_aatsr</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">GriddedData</span><span class="p">(</span><span class="n">fpath_aatsr</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;od550aer&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;AATSR&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550dust&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550so4&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550bc&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550oa&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jonasg</span><span class="o">/</span><span class="n">anaconda3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">6</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">iris</span><span class="o">/</span><span class="n">fileformats</span><span class="o">/</span><span class="n">_pyke_rules</span><span class="o">/</span><span class="n">compiled_krb</span><span class="o">/</span><span class="n">fc_rules_cf_fc</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">1808</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Ignoring</span> <span class="n">netCDF</span> <span class="n">variable</span> <span class="s1">&#39;od550aer&#39;</span> <span class="n">invalid</span> <span class="n">units</span> <span class="s1">&#39;~&#39;</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that, if the longitudes are defined on a 0 -&gt; 360 degree grid, they
are automatically converted to -180 -&gt; 180 (the case of the ECMWF data).</p>
</div>
<div class="section" id="digging-into-the-time-representation-of-the-iris-cube-datatype">
<h3>Digging into the time representation of the iris Cube datatype<a class="headerlink" href="#digging-into-the-time-representation-of-the-iris-cube-datatype" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">GriddedData</span></code> class is based on the <code class="docutils literal notranslate"><span class="pre">iris.Cube</span></code> object, which
can be accessed via the <code class="docutils literal notranslate"><span class="pre">grid</span></code> attribute. In the following, some
features of the <code class="docutils literal notranslate"><span class="pre">Cube</span></code> class are introduced.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cube_ecmwf</span> <span class="o">=</span> <span class="n">data_ecmwf</span><span class="o">.</span><span class="n">grid</span>
<span class="n">cube_aatsr</span> <span class="o">=</span> <span class="n">data_aatsr</span><span class="o">.</span><span class="n">grid</span>
</pre></div>
</div>
<div class="section" id="peculiarities-of-time-handling-when-using-the-cube-interface">
<h4>Peculiarities of time handling when using the <code class="docutils literal notranslate"><span class="pre">Cube</span></code> interface<a class="headerlink" href="#peculiarities-of-time-handling-when-using-the-cube-interface" title="Permalink to this headline">¶</a></h4>
<p>Starting with how time is handled. The time is represented as numerical
value relative to a basic date and frequency unit and in the optimum
case, also the specification of a calendar, according to the <a class="reference external" href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.6/build/cf-conventions.html#time-coordinate">NetCDF CF
conventions</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_ecmwf</span> <span class="o">=</span> <span class="n">cube_ecmwf</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ECMWF</span><span class="se">\n</span><span class="s2">First point:</span><span class="si">%s</span><span class="se">\n</span><span class="s2">Time unit: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Calendar: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                               <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                               <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">calendar</span><span class="p">))</span>
<span class="n">times_aatsr</span><span class="o">=</span> <span class="n">cube_aatsr</span><span class="o">.</span><span class="n">coord</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;AATSR</span><span class="se">\n</span><span class="s2">First point:</span><span class="si">%s</span><span class="se">\n</span><span class="s2">Time unit: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Calendar: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">times_aatsr</span><span class="o">.</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                                             <span class="n">times_aatsr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                                             <span class="n">times_aatsr</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">calendar</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ECMWF</span>
<span class="n">First</span> <span class="n">point</span><span class="p">:</span><span class="mf">0.0</span>
<span class="n">Time</span> <span class="n">unit</span><span class="p">:</span> <span class="n">day</span> <span class="n">since</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.00000000</span> <span class="n">UTC</span>
<span class="n">Calendar</span><span class="p">:</span> <span class="n">gregorian</span>

<span class="n">AATSR</span>
<span class="n">First</span> <span class="n">point</span><span class="p">:</span><span class="mf">0.0</span>
<span class="n">Time</span> <span class="n">unit</span><span class="p">:</span> <span class="n">day</span> <span class="n">since</span> <span class="mi">2008</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.00000000</span> <span class="n">UTC</span>
<span class="n">Calendar</span><span class="p">:</span> <span class="n">julian</span>
</pre></div>
</div>
<p>Note that the AATSR data is defined using a Julian calendar. The actual
time objects are instances of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> class of the iris
package.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">times_aatsr</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;iris.coords.DimCoord&#39;&gt; &lt;class &#39;iris.coords.DimCoord&#39;&gt;
</pre></div>
</div>
<p>Now, if we want to convert these numerically represented time stamps
into datetime-like objects that, for instance, the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library
understands, we have several options. The first one, which is the most
obvious one, is using the provided iris interface which does the
conversion for us, that is, using the <code class="docutils literal notranslate"><span class="pre">cell(index)</span></code> method (with the
corresponding <code class="docutils literal notranslate"><span class="pre">index</span></code>) of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> class in combination with
the <code class="docutils literal notranslate"><span class="pre">cells()</span></code> iterator method. However, as we shall see below, this is
not only the slowest solution but it is also prone to errors in case the
calendar is not standard (e.g.&nbsp;Julian).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0_ecmwf</span> <span class="o">=</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">point</span>
<span class="n">t0_aatsr</span> <span class="o">=</span> <span class="n">times_aatsr</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">point</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First time stamp ECMWF </span><span class="si">%s</span><span class="s2"> (data type: </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First time stamp AATSR </span><span class="si">%s</span><span class="s2"> (data type: </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>First time stamp ECMWF 2018-01-01 00:00:00 (data type: &lt;class &#39;datetime.datetime&#39;&gt;)
First time stamp AATSR 2008-01-01 00:00:00 (data type: &lt;class &#39;netcdftime._netcdftime.DatetimeJulian&#39;&gt;)
</pre></div>
</div>
<p>As you can see, the <code class="docutils literal notranslate"><span class="pre">cell</span></code> method returns different datatypes,
dependent on the CF unit convention, that is, a standard Python
<code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> object, if the calendar is Gregorian, and a
<code class="docutils literal notranslate"><span class="pre">netcdftime._netcdftime.DatetimeJulian</span></code> object in case of a Julian
calendar. Problem here is, that the former is understood by pandas,
while the latter is not.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>

<span class="n">t0_ecmwf_pandas</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">t0_aatsr_pandas</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot convert input [2008-01-01 00:00:00] of type &lt;class &#39;netcdftime._netcdftime.DatetimeJulian&#39;&gt; to Timestamp&quot;</span><span class="p">,)</span>
</pre></div>
</div>
<p>Nontheless, numpy is easier in that sense, since it understands both
datatypes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">t0_ecmwf_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t0_ecmwf</span><span class="p">)</span>
<span class="n">t0_aatsr_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t0_aatsr</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">t0_ecmwf_np</span><span class="p">,</span> <span class="n">t0_aatsr_np</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span> <span class="mi">2008</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.000000</span>
</pre></div>
</div>
<p>Fair enough, but however, in the end we want to ensure to have a
conversion method ready that handles any calendar, and that is
considerably fast. We just saw, that <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> works for both
datetime formats that we get when calling the <code class="docutils literal notranslate"><span class="pre">cell</span></code> method of the
<code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> object that holds the time stamps. However, keep in mind,
that whenever <code class="docutils literal notranslate"><span class="pre">cell</span></code> is called, it performs a conversion of the
numeric value into either <code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code> or, for non-standard
calendars, into a datetime object from the
<a class="reference external" href="https://github.com/Unidata/cftime">cftime</a> package. So, either way,
when using the <code class="docutils literal notranslate"><span class="pre">cell</span></code> method we have to iterate over all indices to
convert the numerical values into datetime-like objects. The latter may
be done using the <code class="docutils literal notranslate"><span class="pre">cells()</span></code> iterator of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code> class.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times_ecmwf_conv</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_ecmwf</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
<span class="n">times_aatsr_conv</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">point</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times_aatsr</span><span class="o">.</span><span class="n">cells</span><span class="p">()]</span>
<span class="c1">#display first two</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="p">(</span><span class="n">times_ecmwf_conv</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span><span class="n">times_aatsr_conv</span><span class="p">[:</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>

<span class="p">[</span><span class="n">netcdftime</span><span class="o">.</span><span class="n">_netcdftime</span><span class="o">.</span><span class="n">DatetimeJulian</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">netcdftime</span><span class="o">.</span><span class="n">_netcdftime</span><span class="o">.</span><span class="n">DatetimeJulian</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
<p>This worked, but however, is it fast?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[t.point for t in times_ecmwf.cells()]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>119 ms ± 2.01 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[t.point for t in times_aatsr.cells()]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>103 ms ± 898 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>The answer is: No, it is not fast, and furthermore, the latter datatype
will not be accepted by pandas as a valid datetime object. We can,
however, convert the datapoints to numpy datetime64 objects during the
conversion (if we want).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[np.datetime64(t.point) for t in times_ecmwf.cells()]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>123 ms ± 3.92 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[np.datetime64(t.point) for t in times_aatsr.cells()]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>110 ms ± 5.43 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>That looks okay, since it does not lead to a notable decrease in the
performance and ensures, that pandas will understand the datatype.
However, about 100ms for conversion of 365 dates is rather slow.</p>
</div>
<div class="section" id="other-options-to-convert-timestamps">
<h4>Other options to convert timestamps<a class="headerlink" href="#other-options-to-convert-timestamps" title="Permalink to this headline">¶</a></h4>
<p>Above we saw how we can convert the numerical timestamps into an array
of numpy <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> objects (which is what we want in the end). As
we shall see below, the conversion can be significantly accelarated if
we do not use the iris interface provided by the <code class="docutils literal notranslate"><span class="pre">cell(index)</span></code> method
and the <code class="docutils literal notranslate"><span class="pre">cells()</span></code> iterator, but rather directly use the underlying
<code class="docutils literal notranslate"><span class="pre">cftime</span></code> library (that iris uses).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
[np.datetime64(t) for t in times_ecmwf.units.num2date(times_ecmwf.points)]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1.73 ms ± 78.6 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<p>This is quite an improvement. But if we dig a little deeper, we can
boost this even more, as we shall see in the following. Basically, what
it does is accessing the base date that is encrypted in the unit, i.e.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">times_ecmwf</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">day</span> <span class="n">since</span> <span class="mi">2018</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span> <span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">00.00000000</span> <span class="n">UTC</span>
</pre></div>
</div>
<p>and based on this base date, and the encrypted temporal resolution (here
<em>day</em>) uses the <a class="reference external" href="https://docs.scipy.org/doc/numpy-1.14.0/reference/arrays.datetime.html">pure numpy datetime
functionality</a>
to convert the stuff. For this, we have to test if the first sub string
(here <em>day</em>) is valid according to the CF standard, which we do using
some features from the <code class="docutils literal notranslate"><span class="pre">netCDF4</span></code> package and by defining a function,
that translates the numerical timestamps into <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> objects
based on the information encoded in the units string(e.g. <em>day since
2018-01-01 00:00:00.00000000 UTC</em>) and the corresponding calendar (e.g.
“gregorian”).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cf_units</span> <span class="k">import</span> <span class="n">Unit</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">MINYEAR</span><span class="p">,</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">asarray</span><span class="p">,</span> <span class="n">datetime64</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="k">import</span> <span class="p">(</span><span class="n">microsec_units</span><span class="p">,</span> <span class="n">millisec_units</span><span class="p">,</span> <span class="n">sec_units</span><span class="p">,</span> <span class="n">min_units</span><span class="p">,</span>
                    <span class="n">hr_units</span><span class="p">,</span> <span class="n">day_units</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">netCDF4._netCDF4</span> <span class="k">import</span> <span class="n">_dateparse</span>
<span class="c1"># Start of the gregorian calendar</span>
<span class="c1"># adapted from here: https://github.com/Unidata/cftime/blob/master/cftime/_cftime.pyx</span>
<span class="n">GREGORIAN_BASE</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">1582</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">cftime_to_datetime64</span><span class="p">(</span><span class="n">timesnum</span><span class="p">,</span> <span class="n">cfunit</span><span class="p">,</span> <span class="n">calendar</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert numerical timestamps with epoch to numpy datetime64</span>

<span class="sd">    This method was designed to enhance the performance of datetime conversions</span>
<span class="sd">    and is based on the corresponding information provided in the cftime</span>
<span class="sd">    package (`see here &lt;https://github.com/Unidata/cftime/blob/master/cftime/</span>
<span class="sd">    _cftime.pyx&gt;`__). Particularly, this object does, what the :func:`num2date`</span>
<span class="sd">    therein does, but faster, in case the time stamps are not defined on a non</span>
<span class="sd">    standard calendar.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    timesnum : :obj:`list` or :obj:`ndarray`</span>
<span class="sd">        array containing numerical time stamps (relative to basedate of</span>
<span class="sd">        ``cfunit``). Can also be a single number.</span>
<span class="sd">    cfunit : :obj:`str` or :obj:`Unit`</span>
<span class="sd">        CF unit string (e.g. day since 2018-01-01 00:00:00.00000000 UTC) or</span>
<span class="sd">        unit</span>
<span class="sd">    calendar : :obj:`str`, optional</span>
<span class="sd">        string specifying calendar (only required if ``cfunit`` is of type</span>
<span class="sd">        ``str``).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ndarray</span>
<span class="sd">        numpy array containing timestamps as datetime64 objects</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        if cfunit is ``str`` and calendar is not provided or invalid, or if</span>
<span class="sd">        the cfunit string is invalid</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>

<span class="sd">    &gt;&gt;&gt; cfunit_str = &#39;day since 2018-01-01 00:00:00.00000000 UTC&#39;</span>
<span class="sd">    &gt;&gt;&gt; cftime_to_datetime64(10, cfunit_str, &quot;gregorian&quot;)</span>
<span class="sd">    array([&#39;2018-01-11T00:00:00.000000&#39;], dtype=&#39;datetime64[us]&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">timesnum</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">timesnum</span> <span class="o">=</span> <span class="p">[</span><span class="n">timesnum</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfunit</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">calendar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Require specification of calendar for &quot;</span>
                             <span class="s2">&quot;conversion into datetime64 objects&quot;</span><span class="p">)</span>
        <span class="n">cfunit</span> <span class="o">=</span> <span class="n">Unit</span><span class="p">(</span><span class="n">cfunit</span><span class="p">,</span> <span class="n">calendar</span><span class="p">)</span> <span class="c1">#raises Error if calendar is invalid</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfunit</span><span class="p">,</span> <span class="n">Unit</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide cfunit either as instance of class &quot;</span>
                         <span class="s2">&quot;cf_units.Unit or as a string&quot;</span><span class="p">)</span>
    <span class="n">cfu_str</span><span class="p">,</span> <span class="n">calendar</span> <span class="o">=</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">calendar</span>
    <span class="n">basedate</span> <span class="o">=</span> <span class="n">_dateparse</span><span class="p">(</span><span class="n">cfu_str</span><span class="p">)</span>
    <span class="n">cfu_str</span> <span class="o">=</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">name</span>
    <span class="n">basedate</span> <span class="o">=</span> <span class="n">_dateparse</span><span class="p">(</span><span class="n">cfu_str</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">((</span><span class="n">calendar</span> <span class="o">==</span> <span class="s1">&#39;proleptic_gregorian&#39;</span> <span class="ow">and</span> <span class="n">basedate</span><span class="o">.</span><span class="n">year</span> <span class="o">&gt;=</span> <span class="n">MINYEAR</span><span class="p">)</span> <span class="ow">or</span>
        <span class="p">(</span><span class="n">calendar</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;gregorian&#39;</span><span class="p">,</span><span class="s1">&#39;standard&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">basedate</span> <span class="o">&gt;</span> <span class="n">GREGORIAN_BASE</span><span class="p">)):</span>
        <span class="n">cfu_str</span> <span class="o">=</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">name</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">cfu_str</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">microsec_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;us&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">millisec_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;ms&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">sec_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">min_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;m&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">hr_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;h&quot;</span>
        <span class="k">elif</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">day_units</span><span class="p">:</span>
            <span class="n">tstr</span> <span class="o">=</span> <span class="s2">&quot;D&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;unsupported time units&#39;</span><span class="p">)</span>

        <span class="n">basedate</span> <span class="o">=</span> <span class="n">datetime64</span><span class="p">(</span><span class="n">basedate</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">basedate</span> <span class="o">+</span> <span class="n">asarray</span><span class="p">(</span><span class="n">timesnum</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;timedelta64[</span><span class="si">%s</span><span class="s2">]&quot;</span> <span class="o">%</span><span class="k">tstr</span>)
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">asarray</span><span class="p">([</span><span class="n">datetime64</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">cfunit</span><span class="o">.</span><span class="n">num2date</span><span class="p">(</span><span class="n">timesnum</span><span class="p">)])</span>
</pre></div>
</div>
<p>Now let’s see how this one performs.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
cftime_to_datetime64(times_ecmwf.points, times_ecmwf.units)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>56 µs ± 802 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
</pre></div>
</div>
</div>
</div>
<div class="section" id="how-pya-does-it">
<h3>How pya does it<a class="headerlink" href="#how-pya-does-it" title="Permalink to this headline">¶</a></h3>
<p>Due to this significant increase in performance for standard calendars
(compared to the methods used in netCDF4), the above method was
implemented in the pya package (<a class="reference external" href="aerocom.met.no/pya/api.html#pya.helpers.cftime_to_datetime64">see
here</a>).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyaerocom.helpers</span> <span class="k">import</span> <span class="n">cftime_to_datetime64</span> <span class="k">as</span> <span class="n">pya_tconversion</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
pya_tconversion(times_ecmwf.points, times_ecmwf.units)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>374 µs ± 46.6 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<p>For the AATSR data, the method is slower, since here, the slower
<code class="docutils literal notranslate"><span class="pre">num2date</span></code> method is used.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
pya_tconversion(times_aatsr.points, times_aatsr.units)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2.18 ms ± 82.2 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<p>Now this is an improvement. Starting with around 100ms when using the
iris interface (i.e.&nbsp;iterating over <code class="docutils literal notranslate"><span class="pre">cells</span></code> of the <code class="docutils literal notranslate"><span class="pre">DimCoord</span></code>), for
conversion of 365 time stamps, we ended up with the order of 10
microseconds. And at the same time the new method ensures that we have
them in a format that also pandas understands.</p>
<p>The method is also the standard conversion method in the
<code class="docutils literal notranslate"><span class="pre">GriddedData.time_stamps()</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
data_ecmwf.time_stamps()
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>405 µs ± 37.9 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">timeit</span>
data_aatsr.time_stamps()
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2.12 ms ± 20.6 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
<div class="section" id="tutorial-showing-how-to-read-ebas-nasa-ames-files">
<h2>Tutorial showing how to read EBAS NASA Ames files<a class="headerlink" href="#tutorial-showing-how-to-read-ebas-nasa-ames-files" title="Permalink to this headline">¶</a></h2>
<p><strong>Note</strong>: this notebook is currently under development</p>
<p>Please see
<a class="reference external" href="https://ebas-submit.nilu.no/Submit-Data/Getting-started">here</a> for
information related to the EBAS NASA Ames file format.</p>
<p><strong>Further links</strong>: - <a class="reference external" href="http://aerocom.met.no/pyaerocom/">Pyaerocom
website</a> - <a class="reference external" href="http://aerocom.met.no/pyaerocom/readme.html#installation">Pyaerocom installation
instructions</a>
- <a class="reference external" href="http://aerocom.met.no/pyaerocom/notebooks.html#getting-started">Getting
started</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pyaerocom.io</span> <span class="k">import</span> <span class="n">EbasNasaAmesFile</span>

<span class="n">ebasdir</span> <span class="o">=</span> <span class="s2">&quot;/lustre/storeA/project/aerocom/aerocom1/AEROCOM_OBSDATA/EBASMultiColumn/data/data/&quot;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;DE0043G.20080101000000.20160708144500.nephelometer..aerosol.1y.1h.DE09L_tsi_neph_3563.DE09L_nephelometer.lev2.nas&quot;</span>

<span class="n">mc</span> <span class="o">=</span> <span class="n">EbasNasaAmesFile</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">ebasdir</span><span class="o">+</span><span class="n">filename</span><span class="p">,</span>
                      <span class="n">only_head</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>          <span class="c1">#set True if you only want to import header</span>
                      <span class="n">replace_invalid_nan</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#replace invalid values with NaNs</span>
                      <span class="n">convert_timestamps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1">#compute datetime64 timestamps from numerical values</span>
                      <span class="n">decode_flags</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>        <span class="c1">#decode all flags (e.g. 0.111222333 -&gt; 111 222 333)</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">EbasNasaAmesFile</span>
<span class="o">--------------------------</span>

   <span class="n">num_head_lines</span><span class="p">:</span> <span class="mi">60</span>
   <span class="n">num_head_fmt</span><span class="p">:</span> <span class="mi">1001</span>
   <span class="n">data_originator</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span>
   <span class="n">sponsor_organisation</span><span class="p">:</span> <span class="n">DE09L</span><span class="p">,</span> <span class="n">Deutscher</span> <span class="n">Wetterdienst</span><span class="p">,</span> <span class="n">DWD</span><span class="p">,</span> <span class="n">Met</span><span class="o">.</span> <span class="n">Obs</span><span class="o">.</span><span class="p">,</span> <span class="n">Hohenspeissenberg</span><span class="p">,</span> <span class="p">,</span> <span class="mi">82283</span><span class="p">,</span> <span class="n">Hohenspeissenberg</span><span class="p">,</span> <span class="n">Germany</span>
   <span class="n">submitter</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span>
   <span class="n">project_association</span><span class="p">:</span> <span class="n">EUSAAR</span> <span class="n">GAW</span><span class="o">-</span><span class="n">WDCA</span>
   <span class="n">vol_num</span><span class="p">:</span> <span class="mi">1</span>
   <span class="n">vol_totnum</span><span class="p">:</span> <span class="mi">1</span>
   <span class="n">ref_date</span><span class="p">:</span> <span class="mi">2008</span> <span class="mi">01</span> <span class="mi">01</span> <span class="mi">2016</span> <span class="mi">07</span> <span class="mi">08</span>
   <span class="n">revision_date</span><span class="p">:</span> <span class="n">nan</span>
   <span class="n">freq</span><span class="p">:</span> <span class="mf">0.041667</span>
   <span class="n">descr_time_unit</span><span class="p">:</span> <span class="n">days</span> <span class="kn">from</span> <span class="nn">file</span> <span class="n">reference</span> <span class="n">point</span>
   <span class="n">num_cols_dependent</span><span class="p">:</span> <span class="mi">11</span>
   <span class="n">mul_factors</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">11</span> <span class="n">items</span><span class="p">)</span>
   <span class="p">[</span><span class="mf">1.0</span>
    <span class="mf">1.0</span>
    <span class="o">...</span>
    <span class="mf">1.0</span>
    <span class="mf">1.0</span><span class="p">]</span>

   <span class="n">vals_invalid</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="mi">11</span> <span class="n">items</span><span class="p">)</span>
   <span class="p">[</span><span class="mf">999.999999</span>
    <span class="mf">999.999</span>
    <span class="o">...</span>
    <span class="mf">9999.9</span>
    <span class="mf">9.999999999</span><span class="p">]</span>

   <span class="n">descr_first_col</span><span class="p">:</span> <span class="n">end_time</span> <span class="n">of</span> <span class="n">measurement</span><span class="p">,</span> <span class="n">days</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">file</span> <span class="n">reference</span> <span class="n">point</span>

   <span class="n">Column</span> <span class="n">variable</span> <span class="n">definitions</span>
   <span class="o">-------------------------------</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">days</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">days</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_backscattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">450.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">550.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">aerosol_light_scattering_coefficient</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">Mm</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">700.0</span> <span class="n">nm</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">hPa</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">relative_humidity</span><span class="p">,</span> <span class="n">unit</span><span class="o">=%</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">K</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">instrument</span> <span class="n">internal</span><span class="p">,</span>
   <span class="n">EbasColDef</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="n">numflag</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">no</span> <span class="n">unit</span><span class="p">,</span> <span class="n">is_var</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_flag</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">flag_id</span><span class="o">=</span><span class="p">,</span>

   <span class="n">EBAS</span> <span class="n">meta</span> <span class="n">data</span>
   <span class="o">------------------</span>
   <span class="n">verbose</span><span class="p">:</span> <span class="kc">False</span>
   <span class="n">data_definition</span><span class="p">:</span> <span class="n">EBAS_1</span><span class="o">.</span><span class="mi">1</span>
   <span class="n">set_type_code</span><span class="p">:</span> <span class="n">TU</span>
   <span class="n">timezone</span><span class="p">:</span> <span class="n">UTC</span>
   <span class="n">file_name</span><span class="p">:</span> <span class="n">DE0043G</span><span class="o">.</span><span class="mf">20080101000000.20160708144500</span><span class="o">.</span><span class="n">nephelometer</span><span class="o">..</span><span class="n">aerosol</span><span class="o">.</span><span class="mi">1</span><span class="n">y</span><span class="o">.</span><span class="mi">1</span><span class="n">h</span><span class="o">.</span><span class="n">DE09L_tsi_neph_3563</span><span class="o">.</span><span class="n">DE09L_nephelometer</span><span class="o">.</span><span class="n">lev2</span><span class="o">.</span><span class="n">nas</span>
   <span class="n">file_creation</span><span class="p">:</span> <span class="mi">20180101031050</span>
   <span class="n">startdate</span><span class="p">:</span> <span class="mi">20080101000000</span>
   <span class="n">revision_date</span><span class="p">:</span> <span class="mi">20160708144500</span>
   <span class="n">statistics</span><span class="p">:</span> <span class="n">arithmetic</span> <span class="n">mean</span>
   <span class="n">data_level</span><span class="p">:</span> <span class="mi">2</span>
   <span class="n">period_code</span><span class="p">:</span> <span class="mi">1</span><span class="n">y</span>
   <span class="n">resolution_code</span><span class="p">:</span> <span class="mi">1</span><span class="n">h</span>
   <span class="n">station_code</span><span class="p">:</span> <span class="n">DE0043G</span>
   <span class="n">platform_code</span><span class="p">:</span> <span class="n">DE0043S</span>
   <span class="n">station_name</span><span class="p">:</span> <span class="n">Hohenpeissenberg</span>
   <span class="n">station_wdca</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span> <span class="n">GAWADE__HPB</span>
   <span class="n">station_gaw</span><span class="o">-</span><span class="nb">id</span><span class="p">:</span> <span class="n">HPB</span>
   <span class="n">station_gaw</span><span class="o">-</span><span class="n">name</span><span class="p">:</span> <span class="n">Hohenpeissenberg</span>
   <span class="n">station_land_use</span><span class="p">:</span> <span class="n">Grassland</span>
   <span class="n">station_setting</span><span class="p">:</span> <span class="n">Mountain</span>
   <span class="n">station_gaw_type</span><span class="p">:</span> <span class="n">G</span>
   <span class="n">station_wmo_region</span><span class="p">:</span> <span class="mi">6</span>
   <span class="n">station_latitude</span><span class="p">:</span> <span class="mf">47.8014984131</span>
   <span class="n">station_longitude</span><span class="p">:</span> <span class="mf">11.0096197128</span>
   <span class="n">station_altitude</span><span class="p">:</span> <span class="mf">985.0</span> <span class="n">m</span>
   <span class="n">regime</span><span class="p">:</span> <span class="n">IMG</span>
   <span class="n">component</span><span class="p">:</span>
   <span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
   <span class="n">matrix</span><span class="p">:</span> <span class="n">aerosol</span>
   <span class="n">laboratory_code</span><span class="p">:</span> <span class="n">DE09L</span>
   <span class="n">instrument_type</span><span class="p">:</span> <span class="n">nephelometer</span>
   <span class="n">instrument_name</span><span class="p">:</span> <span class="n">tsi_neph_3563</span>
   <span class="n">method_ref</span><span class="p">:</span> <span class="n">DE09L_nephelometer</span>
   <span class="n">originator</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span><span class="p">,</span> <span class="n">Harald</span><span class="o">.</span><span class="n">Flentje</span><span class="nd">@dwd</span><span class="o">.</span><span class="n">de</span><span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span>
   <span class="n">submitter</span><span class="p">:</span> <span class="n">Flentje</span><span class="p">,</span> <span class="n">Harald</span><span class="p">,</span> <span class="n">Harald</span><span class="o">.</span><span class="n">Flentje</span><span class="nd">@dwd</span><span class="o">.</span><span class="n">de</span><span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span> <span class="p">,</span>

   <span class="n">Data</span>
   <span class="o">--------</span>
<span class="p">[[</span><span class="mf">0.00000000e+00</span> <span class="mf">4.16670000e-02</span>            <span class="n">nan</span> <span class="o">...</span>            <span class="n">nan</span>
             <span class="n">nan</span> <span class="mf">3.94999000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">4.16670000e-02</span> <span class="mf">8.33330000e-02</span>            <span class="n">nan</span> <span class="o">...</span>            <span class="n">nan</span>
             <span class="n">nan</span> <span class="mf">3.94999000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">8.33330000e-02</span> <span class="mf">1.25000000e-01</span>            <span class="n">nan</span> <span class="o">...</span>            <span class="n">nan</span>
             <span class="n">nan</span> <span class="mf">3.94999000e-01</span><span class="p">]</span>
 <span class="o">...</span>
 <span class="p">[</span><span class="mf">3.65875000e+02</span> <span class="mf">3.65916667e+02</span> <span class="mf">4.75900000e+00</span> <span class="o">...</span> <span class="mf">8.50000000e+00</span>
  <span class="mf">2.99900000e+02</span> <span class="mf">2.47000000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">3.65916667e+02</span> <span class="mf">3.65958310e+02</span> <span class="mf">5.16200000e+00</span> <span class="o">...</span> <span class="mf">8.70000000e+00</span>
  <span class="mf">2.99900000e+02</span> <span class="mf">2.47000000e-01</span><span class="p">]</span>
 <span class="p">[</span><span class="mf">3.65958333e+02</span> <span class="mf">3.66000000e+02</span> <span class="mf">5.31800000e+00</span> <span class="o">...</span> <span class="mf">9.30000000e+00</span>
  <span class="mf">2.99700000e+02</span> <span class="mf">0.00000000e+00</span><span class="p">]]</span>
<span class="n">Colnum</span><span class="p">:</span> <span class="mi">12</span>
<span class="n">Timestamps</span><span class="p">:</span> <span class="mi">8784</span>
</pre></div>
</div>
<div class="section" id="column-information">
<h3>Column information<a class="headerlink" href="#column-information" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">print_col_info</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Column</span> <span class="mi">0</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">starttime</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">days</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span>

<span class="n">Column</span> <span class="mi">1</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">endtime</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">days</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span>

<span class="n">Column</span> <span class="mi">2</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">3</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">4</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_backscattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">5</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">450.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">6</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">550.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">7</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">aerosol_light_scattering_coefficient</span>
<span class="n">unit</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="n">Mm</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">wavelength</span><span class="p">:</span> <span class="mf">700.0</span> <span class="n">nm</span>

<span class="n">Column</span> <span class="mi">8</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">pressure</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">hPa</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">location</span><span class="p">:</span> <span class="n">instrument</span> <span class="n">internal</span>

<span class="n">Column</span> <span class="mi">9</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">relative_humidity</span>
<span class="n">unit</span><span class="p">:</span> <span class="o">%</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">location</span><span class="p">:</span> <span class="n">instrument</span> <span class="n">internal</span>

<span class="n">Column</span> <span class="mi">10</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">temperature</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">K</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">flag_id</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">location</span><span class="p">:</span> <span class="n">instrument</span> <span class="n">internal</span>

<span class="n">Column</span> <span class="mi">11</span>
<span class="n">Pyaerocom</span> <span class="n">EbasColDef</span>
<span class="o">--------------------</span>
<span class="n">name</span><span class="p">:</span> <span class="n">numflag</span>
<span class="n">unit</span><span class="p">:</span> <span class="n">no</span> <span class="n">unit</span>
<span class="n">is_var</span><span class="p">:</span> <span class="kc">False</span>
<span class="n">is_flag</span><span class="p">:</span> <span class="kc">True</span>
<span class="n">flag_id</span><span class="p">:</span>
</pre></div>
</div>
<p>You can see that all variable columns were assigned the same flag
column, since there is only one. This would be different if there were
multiple flag columns (e.g.&nbsp;one for each variable).</p>
</div>
<div class="section" id="access-flag-information">
<h3>Access flag information<a class="headerlink" href="#access-flag-information" title="Permalink to this headline">¶</a></h3>
<p>You can access the flags for each column using the <code class="docutils literal notranslate"><span class="pre">flags</span></code> attribute
of the file.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mc</span><span class="o">.</span><span class="n">flags</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">OrderedDict</span><span class="p">([(</span><span class="s1">&#39;numflag&#39;</span><span class="p">,</span>
              <span class="o">&lt;</span><span class="n">pyaerocom</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ebas_nasa_ames</span><span class="o">.</span><span class="n">EbasFlagCol</span> <span class="n">at</span> <span class="mh">0x7fdb3b12f390</span><span class="o">&gt;</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="s2">&quot;numflag&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>The raw flags can be accessed via:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">raw_data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.394999</span><span class="p">,</span> <span class="mf">0.394999</span><span class="p">,</span> <span class="mf">0.394999</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mf">0.247</span>   <span class="p">,</span> <span class="mf">0.247</span>   <span class="p">,</span> <span class="mf">0.</span>      <span class="p">])</span>
</pre></div>
</div>
<p>And the processed flags are in stored in a (Nx3) numpy array where N is
the total number of timestamps.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">flags</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">394</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">394</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">394</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="o">...</span><span class="p">,</span>
       <span class="p">[</span><span class="mi">247</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">247</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<p>For instance, access the flags of the 5 timestamp:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flagcol</span><span class="o">.</span><span class="n">flags</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">394</span><span class="p">,</span> <span class="mi">999</span><span class="p">,</span>   <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="convert-object-to-pandas-dataframe">
<h3>Convert object to pandas Dataframe<a class="headerlink" href="#convert-object-to-pandas-dataframe" title="Permalink to this headline">¶</a></h3>
<p>The conversion does currently exclude all flag columns</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">mc</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aerosol_light_backscattering_coefficient</th>
      <th>aerosol_light_backscattering_coefficient</th>
      <th>aerosol_light_backscattering_coefficient</th>
      <th>aerosol_light_scattering_coefficient</th>
      <th>aerosol_light_scattering_coefficient</th>
      <th>aerosol_light_scattering_coefficient</th>
      <th>pressure</th>
      <th>relative_humidity</th>
      <th>temperature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2008-01-01 00:30:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2008-01-01 01:29:59</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2008-01-01 02:29:59</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2008-01-01 03:30:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2008-01-01 04:29:59</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="ebas-file-query-and-database-browser">
<h2>EBAS file query and database browser<a class="headerlink" href="#ebas-file-query-and-database-browser" title="Permalink to this headline">¶</a></h2>
<p>The previous tutorial showed how to read EBAS NASA Ames files and gave
insights into the structure of these files. However, this did not
include the specification of an actual data request (for instance: get
data from all stations in the arctic that contain measurements of the
AOD between 2010 and 2016).</p>
<p>In this tutorial, we show, how such requests can be specified easily in
pyaerocom and how the database can be browsed for instance by variable
name, type of instrument, location or other relevant parameters.</p>
<p>The notebook is categorised as follows:</p>
<ul class="simple">
<li>Defining a request</li>
<li>Retrieve all files for a request</li>
<li>Browse the database</li>
</ul>
<div class="section" id="specifying-a-request">
<h3>Specifying a request<a class="headerlink" href="#specifying-a-request" title="Permalink to this headline">¶</a></h3>
<p>Request parameters can be specified using the <code class="docutils literal notranslate"><span class="pre">EbasSQLRequest</span></code> class.
E.g.:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyaerocom</span> <span class="k">as</span> <span class="nn">pya</span>

<span class="n">request</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">ebas_file_index</span><span class="o">.</span><span class="n">EbasSQLRequest</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span>
                                                             <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span>
                                                             <span class="s1">&#39;pressure&#39;</span><span class="p">),</span>
                                                  <span class="n">start_date</span><span class="o">=</span><span class="s2">&quot;2010-01-01&quot;</span><span class="p">,</span>
                                                  <span class="n">stop_date</span><span class="o">=</span><span class="s2">&quot;2011-01-01&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">EbasSQLRequest</span>
<span class="o">------------------------</span>
<span class="n">variables</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
<span class="n">start_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">stop_date</span><span class="p">:</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">station_names</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">matrices</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">altitude_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lon_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lat_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">instrument_types</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">statistics</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">Filename</span> <span class="n">request</span> <span class="n">string</span><span class="p">:</span>
<span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>You can also output the actual SQL query string:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">make_query_str</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>The request class is an extended dictionary and can thus be used like a
dictionary:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">instrument_types</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;nephelometer&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pyaerocom</span> <span class="n">EbasSQLRequest</span>
<span class="o">------------------------</span>
<span class="n">variables</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
<span class="n">start_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">stop_date</span><span class="p">:</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">station_names</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">matrices</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">altitude_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lon_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lat_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">instrument_types</span><span class="p">:</span> <span class="n">nephelometer</span>
<span class="n">statistics</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">Filename</span> <span class="n">request</span> <span class="n">string</span><span class="p">:</span>
<span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">instr_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;nephelometer&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="execution-of-file-request-query">
<h3>Execution of file request query<a class="headerlink" href="#execution-of-file-request-query" title="Permalink to this headline">¶</a></h3>
<p>Now that we have defined which files we would like to look into, we can
execute the query and retrieve all files that match our specifications.
This can be done with the <code class="docutils literal notranslate"><span class="pre">EbasFileIndex</span></code> class:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">EbasFileIndex</span><span class="p">()</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of files found:</span><span class="si">{}</span><span class="se">\n</span><span class="s2">Request:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">files</span> <span class="n">found</span><span class="p">:</span><span class="mi">56</span>
<span class="n">Request</span><span class="p">:</span>

<span class="n">Pyaerocom</span> <span class="n">EbasSQLRequest</span>
<span class="o">------------------------</span>
<span class="n">variables</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
<span class="n">start_date</span><span class="p">:</span> <span class="mi">2010</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">stop_date</span><span class="p">:</span> <span class="mi">2011</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span>
<span class="n">station_names</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">matrices</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">altitude_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lon_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">lat_range</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">instrument_types</span><span class="p">:</span> <span class="n">nephelometer</span>
<span class="n">statistics</span><span class="p">:</span> <span class="kc">None</span>
<span class="n">Filename</span> <span class="n">request</span> <span class="n">string</span><span class="p">:</span>
<span class="n">select</span> <span class="n">distinct</span> <span class="n">filename</span> <span class="kn">from</span> <span class="nn">variable</span> <span class="n">join</span> <span class="n">station</span> <span class="n">on</span> <span class="n">station</span><span class="o">.</span><span class="n">station_code</span><span class="o">=</span><span class="n">variable</span><span class="o">.</span><span class="n">station_code</span> <span class="n">where</span> <span class="n">instr_type</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;nephelometer&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,</span> <span class="s1">&#39;pressure&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">first_end</span> <span class="o">&lt;</span> <span class="s1">&#39;2011-01-01&#39;</span> <span class="ow">and</span> <span class="n">last_start</span> <span class="o">&gt;</span> <span class="s1">&#39;2010-01-01&#39;</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="browsing-the-database">
<h3>Browsing the database<a class="headerlink" href="#browsing-the-database" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">EbasFileIndex</span></code> class provides some convenience function that
allow to browse meta information for a given request. These are
illustrated in the following:</p>
<p>For instance, we can check, what variables could actually be retrieved
in the request:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_variables</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;pressure&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_backscattering_coefficient&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;aerosol_light_scattering_coefficient&#39;</span><span class="p">,)]</span>
</pre></div>
</div>
<p>Or what matrices the data contains:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_matrices</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;instrument&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;aerosol&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;pm10&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;pm1&#39;</span><span class="p">,)]</span>
</pre></div>
</div>
<p>Or which station coordinates (lon, lat) the dataset contains:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_coordinates</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mf">23.583333</span><span class="p">,</span> <span class="mf">42.166667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">79.783839</span><span class="p">,</span> <span class="mf">44.231006</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">122.9576034546</span><span class="p">,</span> <span class="mf">50.059299469</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">104.986864</span><span class="p">,</span> <span class="mf">54.353743</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">62.3415260315</span><span class="p">,</span> <span class="mf">82.4991455078</span><span class="p">),</span> <span class="p">(</span><span class="mf">7.985</span><span class="p">,</span> <span class="mf">46.5475</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.0096197128</span><span class="p">,</span> <span class="mf">47.8014984131</span><span class="p">),</span> <span class="p">(</span><span class="mf">12.93386</span><span class="p">,</span> <span class="mf">51.53014</span><span class="p">),</span> <span class="p">(</span><span class="mf">10.97964</span><span class="p">,</span> <span class="mf">47.4165</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">8.266</span><span class="p">,</span> <span class="o">-</span><span class="mf">70.666</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">16.4994</span><span class="p">,</span> <span class="mf">28.309</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">3.605</span><span class="p">,</span> <span class="mf">37.164</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.35</span><span class="p">,</span> <span class="mf">41.766667</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.283333</span><span class="p">,</span> <span class="mf">61.85</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.116111111</span><span class="p">,</span> <span class="mf">67.973333333</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.95</span><span class="p">,</span> <span class="mf">45.76667</span><span class="p">),</span> <span class="p">(</span><span class="mf">25.666667</span><span class="p">,</span> <span class="mf">35.316667</span><span class="p">),</span> <span class="p">(</span><span class="mf">19.583333</span><span class="p">,</span> <span class="mf">46.966667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">9.89944</span><span class="p">,</span> <span class="mf">53.32583</span><span class="p">),</span> <span class="p">(</span><span class="mf">77.151389</span><span class="p">,</span> <span class="mf">28.427778</span><span class="p">),</span> <span class="p">(</span><span class="mf">8.633333</span><span class="p">,</span> <span class="mf">45.8</span><span class="p">),</span> <span class="p">(</span><span class="mf">10.7</span><span class="p">,</span> <span class="mf">44.183333</span><span class="p">),</span> <span class="p">(</span><span class="mf">126.17</span><span class="p">,</span> <span class="mf">33.28</span><span class="p">),</span> <span class="p">(</span><span class="mf">4.926389</span><span class="p">,</span> <span class="mf">51.970278</span><span class="p">),</span> <span class="p">(</span><span class="mf">8.252</span><span class="p">,</span> <span class="mf">58.38853</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.888333</span><span class="p">,</span> <span class="mf">78.906667</span><span class="p">),</span> <span class="p">(</span><span class="mf">2.533333</span><span class="p">,</span> <span class="o">-</span><span class="mf">72.016667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">65.618</span><span class="p">,</span> <span class="mf">18.381</span><span class="p">),</span> <span class="p">(</span><span class="mf">13.15</span><span class="p">,</span> <span class="mf">56.016667</span><span class="p">),</span> <span class="p">(</span><span class="mf">120.87</span><span class="p">,</span> <span class="mf">23.47</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">156.6114654541</span><span class="p">,</span> <span class="mf">71.3230133057</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">111.9841</span><span class="p">,</span> <span class="mf">35.9731</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">112.1288</span><span class="p">,</span> <span class="mf">36.0778</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">111.6832</span><span class="p">,</span> <span class="mf">34.3405</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">112.8</span><span class="p">,</span> <span class="mf">31.9506</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">109.3889</span><span class="p">,</span> <span class="mf">32.0097</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">155.5761566162</span><span class="p">,</span> <span class="mf">19.5362300873</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">86.148</span><span class="p">,</span> <span class="mf">37.1317</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">68.2608</span><span class="p">,</span> <span class="mf">44.3772</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">113.9958</span><span class="p">,</span> <span class="mf">48.5103</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">81.7</span><span class="p">,</span> <span class="mf">36.2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">103.1772</span><span class="p">,</span> <span class="mf">29.3022</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">97.5</span><span class="p">,</span> <span class="mf">36.6</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">24.7999992371</span><span class="p">,</span> <span class="o">-</span><span class="mf">89.9969482422</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">124.1510009766</span><span class="p">,</span> <span class="mf">41.0541000366</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">105.5457</span><span class="p">,</span> <span class="mf">40.2783</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">111.9692</span><span class="p">,</span> <span class="mf">35.1406</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">77.04</span><span class="p">,</span> <span class="mf">38.9</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">109.7958</span><span class="p">,</span> <span class="mf">34.9139</span><span class="p">),</span> <span class="p">(</span><span class="mf">18.48968</span><span class="p">,</span> <span class="o">-</span><span class="mf">34.35348</span><span class="p">)]</span>
</pre></div>
</div>
<p>Now, let’s narrow this down:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">request</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">lat_range</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_coordinates</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="o">-</span><span class="mf">62.3415260315</span><span class="p">,</span> <span class="mf">82.4991455078</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.283333</span><span class="p">,</span> <span class="mf">61.85</span><span class="p">),</span> <span class="p">(</span><span class="mf">24.116111111</span><span class="p">,</span> <span class="mf">67.973333333</span><span class="p">),</span> <span class="p">(</span><span class="mf">11.888333</span><span class="p">,</span> <span class="mf">78.906667</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">156.6114654541</span><span class="p">,</span> <span class="mf">71.3230133057</span><span class="p">)]</span>
</pre></div>
</div>
<p>Print all station names:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">contains_station_names</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;Alert&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Hyytiälä&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Pallas (Sammaltunturi)&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Zeppelin mountain (Ny-Ålesund)&#39;</span><span class="p">,),</span> <span class="p">(</span><span class="s1">&#39;Barrow&#39;</span><span class="p">,)]</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-browsing">
<h3>Custom browsing<a class="headerlink" href="#custom-browsing" title="Permalink to this headline">¶</a></h3>
<p>The previous browsing methods (e.g. <code class="docutils literal notranslate"><span class="pre">contains_coordinates()</span></code>,
<code class="docutils literal notranslate"><span class="pre">contains_matrices</span></code>, <code class="docutils literal notranslate"><span class="pre">contains_variables</span></code>) are all just simple
wrappers for the general query method <code class="docutils literal notranslate"><span class="pre">make_query_str</span></code> of the
<code class="docutils literal notranslate"><span class="pre">EbasSQLRequest</span></code> class, that is then called by the <code class="docutils literal notranslate"><span class="pre">EbasFileIndex</span></code>
class using the method <code class="docutils literal notranslate"><span class="pre">execute_request</span></code>). Thus, if needed, you may
define your own request simply by using the provided interface. Here an
example using the request constraints specified above. Let’s say we want
to retrieve a list of station names and their coordinates (lon, lat,
alt). This can be done by calling (we store the results in a list named
<code class="docutils literal notranslate"><span class="pre">station_info</span></code>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query_str</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">make_query_str</span><span class="p">(</span><span class="n">what</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;station_name&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;station_longitude&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;station_latitude&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;station_altitude&quot;</span><span class="p">))</span>

<span class="n">station_info</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_request</span><span class="p">(</span><span class="n">query_str</span><span class="p">)</span>

<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">station_info</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="s1">&#39;Alert&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">62.3415260315</span><span class="p">,</span> <span class="mf">82.4991455078</span><span class="p">,</span> <span class="mf">210.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Hyytiälä&#39;</span><span class="p">,</span> <span class="mf">24.283333</span><span class="p">,</span> <span class="mf">61.85</span><span class="p">,</span> <span class="mf">181.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Pallas (Sammaltunturi)&#39;</span><span class="p">,</span> <span class="mf">24.116111111</span><span class="p">,</span> <span class="mf">67.973333333</span><span class="p">,</span> <span class="mf">565.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Zeppelin mountain (Ny-Ålesund)&#39;</span><span class="p">,</span> <span class="mf">11.888333</span><span class="p">,</span> <span class="mf">78.906667</span><span class="p">,</span> <span class="mf">474.0</span><span class="p">)</span>
<span class="p">(</span><span class="s1">&#39;Barrow&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">156.6114654541</span><span class="p">,</span> <span class="mf">71.3230133057</span><span class="p">,</span> <span class="mf">11.0</span><span class="p">)</span>
</pre></div>
</div>
<p>You can see that the results for each station are stored in tuples in
the order of the request.</p>
</div>
<div class="section" id="read-all-files">
<h3>Read all files<a class="headerlink" href="#read-all-files" title="Permalink to this headline">¶</a></h3>
<p>Let’s update the file list and read all files.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">files</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">execute_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Total number of files found: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">files</span> <span class="n">found</span><span class="p">:</span> <span class="mi">7</span>
</pre></div>
</div>
<p>Let’s read the files:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">const</span><span class="o">.</span><span class="n">OBSCONFIG</span><span class="p">[</span><span class="s2">&quot;EBASMC&quot;</span><span class="p">][</span><span class="s2">&quot;PATH&quot;</span><span class="p">],</span> <span class="s1">&#39;data&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pya</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">EbasNasaAmesFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="readme.html" class="btn btn-neutral" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, met.no.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>